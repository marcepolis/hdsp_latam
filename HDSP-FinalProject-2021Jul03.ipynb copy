{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Salud a la vuelta de la esquina"
   ]
  },
  {
   "attachments": {
    "image.png": {
     "image/png": "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"
    }
   },
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Planteamiento del problema\n",
    "Tanto los diseñadores de política pública como la administración de centros de salud (hospitales, consultorios, clínicas), sean públicos o privados, deben ser capaces de identificar las áreas de oportunidad, geográficamente hablando, de dónde invertir recursos en proyectos o nuevas locaciones y crear el mayor impacto. De lo contrario, la ubicación de dichos centros podrá convertirse en una limitante para que personas que residen en lugares lejanos puedan acceder a ellos (Venkatesh & Metri, 2011). Además, los ciudadanos de un país deben ser capaces de poder influir en las decisiones que las personas toman.  Con este proyecto buscamos que los ciudadanos tengan mayor información acerca de las trayectorias y los puntos más cercanos (y alejados) entre pacientes y los centros de salud.\n",
    "\n",
    "## Justificación\n",
    "Desigualdades en el estatus de salud de las personas en los grupos de México refleja las desigualdades en el sistema. Por ejemplo, 40% de las mujeres indígenas han mostrado ser anémicas comparadas con el 26% del promedio nacional (Barraza-Lloréns y otros, 2002). Diferencias en ingreso y financiento han demostrado estar entre los factores que aumentan esta desigualdad (Barraza-Lloréns y otros, 2002). La distancia entre la vivienda de un paciente y su centro de salud como muestra la investigación de (Venkatesh & Metri, 2011) es otro factor que aumenta la desigualdad en acceso a salud. \n",
    "\n",
    "\n",
    "## Diseño de la solución\n",
    "Utilizaremos un diagrama de Voronoi superpuesto con un mapa de calor de la densidad poblacional para identificar aquellas zonas donde existen pocos centros de salud y una mayor densidad poblacional y viceversa. La idea del diagrama de Voronoi se basa fundamentalmente en la proximidad. Suponemos un conjunto de 12 hospitales en el plano siguiente, el diagrama de Voronoi asignará a cada punto del plano el hospital más cercano a él de tal manera que cada punto esté a la misma o menor distancia.\n",
    "\n",
    "![image.png](attachment:image.png)\n",
    "\n",
    "## Fuentes de datos a utilizar\n",
    "\n",
    "Dada la confidencialidad de los pacientes, como equipo tuvimos dificultades para acceder al código postal donde residen. \n",
    "\n",
    "- Datos clues: Utilizamos datos de los centros médicos; sin embargo, nos enfocamos en hacer el análisis para Baja California para realizar la prueba de concepto, sin embargo, en un futuro, con el tratamiento de datos debido, se puede usar cualquier base.\n",
    "http://www.dgis.salud.gob.mx/contenidos/intercambio/clues_gobmx.html\n",
    "\n",
    "\n",
    "- Datos de pacientes: Ocupamos datos dummies de códigos postales de Baja California y los asignamos de manera aleatoria. Estos fueron obtenidos usando el módulo de pgeocode Nominatim.\n",
    "https://pgeocode.readthedocs.io/en/latest/generated/pgeocode.Nominatim.html\n",
    "\n",
    "\n",
    "- Datos de densidad poblacional: Se realizó con la base de datos del Censo de Población por localidad (ITER)\n",
    "https://www.inegi.org.mx/app/descarga/ficha.html?tit=326108&ag=0&f=csv\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Código"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Librerías necesarias para el análisis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "#pip install pgeocode\n",
    "#pip install ipywidgets\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import geopandas as gpd # To create GeodataFrame\n",
    "\n",
    "from shapely.geometry import Point # Shapely for converting latitude/longtitude to geometry\n",
    "from turfpy.transformation import voronoi\n",
    "from ipyleaflet import Map, GeoJSON, LayersControl, Marker"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Localización de Centros de Salud y áreas de cercanía"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "El método que se usó para localizar los Centros de Salud (CLUES) fue mediante un diagrama de voronoi. \n",
    "\n",
    "El diagrama de voronoi toma puntos geográficos (en este caso los CLUES) y se realiza una transformación de celdas alrededor de estos puntos. Estas celdas significan el área que cubre todos los puntos más cercanos a ese punto referente."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Importar base de datos de clues de Baja California. Esta base ya se encuentra previamente filtrada.\n",
    "clues = pd.read_csv('https://storage.googleapis.com/hdsp-data/cluesbcpoints.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(-115.428741, 32.6675696),\n",
       " (-116.920376, 32.513351799999995),\n",
       " (-117.05638, 32.34203),\n",
       " (-116.9639735, 32.5071871),\n",
       " (-115.4347215, 32.6246426),\n",
       " (-116.6023642, 31.845653499999997),\n",
       " (-116.93803038833175, 32.50697167766443),\n",
       " (-115.45480862379486, 32.682955517352816),\n",
       " (-116.0646908, 30.8450989),\n",
       " (-115.9292764, 30.5262942),\n",
       " (-116.206, 31.0654),\n",
       " (-116.4065875, 31.5516684),\n",
       " (-116.626, 32.0761),\n",
       " (-114.001, 28.281999999999996),\n",
       " (-115.992895, 30.709146),\n",
       " (-115.295, 32.2934),\n",
       " (-115.31, 32.4683),\n",
       " (-115.0923205, 32.602775699999995),\n",
       " (-115.139, 32.3103),\n",
       " (-115.372, 32.4412),\n",
       " (-116.6059321, 31.8566941),\n",
       " (-117.044, 32.5347),\n",
       " (-117.044, 32.5347),\n",
       " (-117.013435, 32.4435904),\n",
       " (-115.481331, 32.590645),\n",
       " (-116.01469556152392, 30.7613474125708),\n",
       " (-116.00383062988294, 30.73551055204616),\n",
       " (-116.0146955615237, 30.7613474125708),\n",
       " (-116.00383062988294, 30.72370590280059),\n",
       " (-116.605672, 31.85704),\n",
       " (-116.5919062, 31.863171100000002),\n",
       " (-116.6215816, 31.8626048),\n",
       " (-115.939494, 30.557021999999996),\n",
       " (-115.175, 28.1111),\n",
       " (-115.192, 28.0958),\n",
       " (-115.723506, 30.060498),\n",
       " (-116.248, 31.3273),\n",
       " (-116.6998119, 31.896767699999998),\n",
       " (-116.6195097, 32.0774801),\n",
       " (-115.466105, 32.662184),\n",
       " (-115.468014, 32.662077000000004),\n",
       " (-115.4954649, 32.6405844),\n",
       " (-115.420898, 32.6237024),\n",
       " (-115.4566058, 32.636207),\n",
       " (-115.3921688, 32.627376),\n",
       " (-115.0002067, 32.5691405),\n",
       " (-114.8464872, 32.6339113),\n",
       " (-115.1925126, 32.4197887),\n",
       " (-114.9224994, 32.5115417),\n",
       " (-115.1014606, 32.2862386),\n",
       " (-114.8343064, 31.0213916),\n",
       " (-115.252, 32.2492),\n",
       " (-116.622, 32.5749),\n",
       " (-117.009468, 32.513819),\n",
       " (-116.965212, 32.499365000000004),\n",
       " (-117.0448453, 32.5308195),\n",
       " (-116.940377, 32.4843805),\n",
       " (-117.0791887, 32.532004),\n",
       " (-116.880188, 32.4657045),\n",
       " (-116.9, 32.503),\n",
       " (-116.973, 32.5302),\n",
       " (-117.044, 32.5347),\n",
       " (-117.0558945, 32.3413607),\n",
       " (-115.468, 32.6633),\n",
       " (-117.044, 32.5347),\n",
       " (-116.926816, 32.477086),\n",
       " (-116.6309957, 32.544096100000004),\n",
       " (-116.9526142, 32.533816200000004),\n",
       " (-116.831108, 32.465843),\n",
       " (-115.48136, 32.590371000000005),\n",
       " (-115.468, 32.6633),\n",
       " (-117.044, 32.5347),\n",
       " (-116.63384, 32.547503000000006),\n",
       " (-116.9261, 32.4755),\n",
       " (-115.3826, 32.608992),\n",
       " (-117.046768, 32.339159),\n",
       " (-116.607728, 31.850271999999997),\n",
       " (-115.194, 28.0953),\n",
       " (-115.938236, 30.55739),\n",
       " (-115.47638, 32.6438),\n",
       " (-115.1973578, 32.3561626),\n",
       " (-114.8326314, 31.032737899999997),\n",
       " (-114.7325261, 32.7168679),\n",
       " (-116.6055123, 32.569415299999996),\n",
       " (-116.984823, 32.508255),\n",
       " (-116.245, 31.3276),\n",
       " (-115.723, 31.397),\n",
       " (-115.723721, 30.060494),\n",
       " (-117.052, 32.3428),\n",
       " (-116.9334228, 32.545993800000005),\n",
       " (-116.9841627, 32.4868147),\n",
       " (-115.4655036, 32.643605300000004),\n",
       " (-115.504258, 32.640176000000004),\n",
       " (-116.59787084, 31.80684381),\n",
       " (-115.468, 32.6633),\n",
       " (-116.60423, 31.791066999999998),\n",
       " (-117.02126, 32.471543),\n",
       " (-116.605719, 31.833644),\n",
       " (-116.59563, 31.847927000000002),\n",
       " (-115.471421, 32.633369),\n",
       " (-115.4364381, 32.637603999999996),\n",
       " (-117.092097, 32.530442),\n",
       " (-116.9849299, 32.50711),\n",
       " (-116.614659, 31.851613),\n",
       " (-116.594541, 31.860771999999997),\n",
       " (-115.1946399, 32.4140328),\n",
       " (-114.993, 32.5672),\n",
       " (-114.8324577, 31.0328673),\n",
       " (-115.4401265, 32.651393),\n",
       " (-116.8651384, 32.503484),\n",
       " (-116.2495003, 31.326898),\n",
       " (-117.063004, 32.359401500000004),\n",
       " (-115.4522472, 32.665009399999995),\n",
       " (-116.8106173, 32.4642844),\n",
       " (-117.074452, 32.518817999999996),\n",
       " (-115.48136, 32.590371000000005),\n",
       " (-115.4730443, 32.6572121),\n",
       " (-115.3855231, 32.599739),\n",
       " (-115.47113, 32.64047),\n",
       " (-115.47343, 32.65733),\n",
       " (-115.451038, 32.560284),\n",
       " (-116.001249, 30.499869),\n",
       " (-116.6317267, 31.8731934),\n",
       " (-115.988876, 30.7258),\n",
       " (-115.942037, 30.56008),\n",
       " (-115.459772, 32.665436),\n",
       " (-115.476852, 32.665728),\n",
       " (-115.395391, 32.592819),\n",
       " (-115.390523, 32.667891),\n",
       " (-115.505804, 32.652965),\n",
       " (-117.032791, 32.534454),\n",
       " (-116.877093, 32.473605),\n",
       " (-116.889846, 32.500097),\n",
       " (-116.83991, 32.4766002),\n",
       " (-117.01829, 32.534062),\n",
       " (-117.025754, 32.52888),\n",
       " (-117.042581, 32.484612),\n",
       " (-117.064432, 32.525502),\n",
       " (-116.911291, 32.454621),\n",
       " (-116.909471, 32.511451),\n",
       " (-116.9312759, 32.4740075),\n",
       " (-116.874121, 32.468029),\n",
       " (-116.8962719499541, 32.52491455403034),\n",
       " (-116.875462, 32.485291),\n",
       " (-116.98541929999999, 32.505035),\n",
       " (-117.047648, 32.534589000000004),\n",
       " (-116.990297, 32.509704),\n",
       " (-117.039174, 32.533954),\n",
       " (-117.007392, 32.518553000000004),\n",
       " (-116.889508, 32.505824),\n",
       " (-116.985891, 32.519816999999996),\n",
       " (-117.119156, 32.531923),\n",
       " (-116.993624, 32.531101),\n",
       " (-116.61640757913119, 31.86305059599705),\n",
       " (-116.613977, 31.851608000000002),\n",
       " (-116.611835, 31.861061),\n",
       " (-116.622578, 31.870831),\n",
       " (-116.623749, 31.854549),\n",
       " (-116.594444, 31.811387),\n",
       " (-116.999478, 32.498404),\n",
       " (-117.025719, 32.528901),\n",
       " (-116.97425, 32.4588064),\n",
       " (-117.055454, 32.509964000000004),\n",
       " (-117.0407221, 32.538850800000006),\n",
       " (-117.020777, 32.51963),\n",
       " (-117.022427, 32.50738),\n",
       " (-116.972429, 32.488067),\n",
       " (-117.062322, 32.498438),\n",
       " (-116.889739, 32.501436),\n",
       " (-116.880358, 32.4863127),\n",
       " (-117.043226, 32.532951000000004),\n",
       " (-116.940739, 32.484576000000004),\n",
       " (-116.940484, 32.53352),\n",
       " (-116.887452, 32.514879),\n",
       " (-117.04100540000002, 32.5303745),\n",
       " (-116.940429, 32.487144),\n",
       " (-117.028055, 32.538441),\n",
       " (-117.014652, 32.52162),\n",
       " (-117.037157, 32.478821),\n",
       " (-117.017944, 32.514818),\n",
       " (-116.915414, 32.507527),\n",
       " (-117.015965, 32.522572),\n",
       " (-117.045101, 32.533115),\n",
       " (-116.913906, 32.510002),\n",
       " (-116.972547, 32.456516),\n",
       " (-117.022649, 32.526457),\n",
       " (-117.080745, 32.510851),\n",
       " (-117.071029, 32.483211),\n",
       " (-117.057793, 32.514635999999996),\n",
       " (-116.864108, 32.518995000000004),\n",
       " (-116.925179, 32.524054),\n",
       " (-117.045496, 32.531932),\n",
       " (-117.065452, 32.51267),\n",
       " (-116.96848, 32.49987),\n",
       " (-117.057138, 32.512487),\n",
       " (-117.067966, 32.524775),\n",
       " (-116.938718, 32.482521999999996),\n",
       " (-117.05776177346706, 32.514379225025614),\n",
       " (-116.957325, 32.49434),\n",
       " (-116.94549, 32.51301339),\n",
       " (-116.9171085, 32.4678006),\n",
       " (-117.046592, 32.5345),\n",
       " (-116.927952, 32.489884),\n",
       " (-117.008934, 32.520942),\n",
       " (-117.039863, 32.531933),\n",
       " (-117.046115, 32.526856),\n",
       " (-117.067819, 32.480239000000005),\n",
       " (-116.950425, 32.479421),\n",
       " (-117.06937439739704, 32.48364423250928),\n",
       " (-117.063444, 32.483888),\n",
       " (-116.966669, 32.502724),\n",
       " (-116.877034, 32.473597),\n",
       " (-117.011879, 32.52109),\n",
       " (-116.879799, 32.513721000000004),\n",
       " (-116.875772, 32.477392),\n",
       " (-116.940253, 32.48328),\n",
       " (-116.93138, 32.545406),\n",
       " (-116.957606, 32.490389),\n",
       " (-116.933504, 32.544179),\n",
       " (-117.024306, 32.530751),\n",
       " (-116.937287, 32.47929),\n",
       " (-117.117743, 32.533205),\n",
       " (-117.037687, 32.527282),\n",
       " (-117.040261, 32.48283),\n",
       " (-116.901785, 32.543972),\n",
       " (-116.869832, 32.468007),\n",
       " (-116.851095, 32.513675),\n",
       " (-116.931632, 32.522034999999995),\n",
       " (-117.045997, 32.539875),\n",
       " (-116.969557, 32.467674),\n",
       " (-117.011434, 32.529999),\n",
       " (-116.965402, 32.487927),\n",
       " (-116.899836, 32.543849),\n",
       " (-117.053271, 32.336793),\n",
       " (-117.005603, 32.525692),\n",
       " (-116.873893, 32.476911),\n",
       " (-117.0551, 32.3384705),\n",
       " (-115.485002, 32.662101),\n",
       " (-115.47327, 32.662290000000006),\n",
       " (-115.504932, 32.656195000000004),\n",
       " (-115.434559, 32.632636),\n",
       " (-115.495212, 32.657073),\n",
       " (-115.429051, 32.620682),\n",
       " (-115.49682, 32.63702),\n",
       " (-115.515742, 32.657653),\n",
       " (-115.431182, 32.660127),\n",
       " (-115.479401, 32.663932),\n",
       " (-117.012551, 32.520846),\n",
       " (-115.478517, 32.644199),\n",
       " (-115.495553, 32.642736),\n",
       " (-115.401863, 32.582238000000004),\n",
       " (-115.516445, 32.639089),\n",
       " (-115.483994, 32.664932),\n",
       " (-115.47526, 32.664198),\n",
       " (-115.433489, 32.651798),\n",
       " (-115.459189, 32.665601),\n",
       " (-115.478786, 32.654092),\n",
       " (-115.451319, 32.662387),\n",
       " (-117.017328, 32.523055),\n",
       " (-117.034711, 32.534345),\n",
       " (-117.010651, 32.531237),\n",
       " (-117.05597, 32.341927),\n",
       " (-117.030252, 32.520219),\n",
       " (-116.964243, 32.461425),\n",
       " (-116.926886, 32.52098),\n",
       " (-116.970955, 32.501290000000004),\n",
       " (-116.951423, 32.488509),\n",
       " (-116.878947, 32.513766),\n",
       " (-117.666303, 32.571358000000004),\n",
       " (-116.931155, 32.543890000000005),\n",
       " (-116.915071, 32.449533),\n",
       " (-117.057228, 32.511448),\n",
       " (-116.935038, 32.544039),\n",
       " (-117.054666, 32.533998),\n",
       " (-117.04723, 32.53389),\n",
       " (-116.9101245, 32.4627142),\n",
       " (-117.116784, 32.518231),\n",
       " (-116.852429, 32.512127),\n",
       " (-116.8349175, 32.4717673),\n",
       " (-117.056469, 32.340215),\n",
       " (-117.044, 32.5347),\n",
       " (-116.911264, 32.460831),\n",
       " (-117.007567, 32.528186),\n",
       " (-117.002545, 32.535065),\n",
       " (-117.047125, 32.533448),\n",
       " (-116.894991, 32.545286),\n",
       " (-117.059732, 32.353649),\n",
       " (-117.031278, 32.514028),\n",
       " (-117.032119, 32.525936),\n",
       " (-116.919298, 32.507132),\n",
       " (-116.981766, 32.529446),\n",
       " (-116.971621, 32.490656),\n",
       " (-116.987516, 32.519799),\n",
       " (-117.028831, 32.521074),\n",
       " (-116.621165, 32.3695207),\n",
       " (-116.980573, 32.529292),\n",
       " (-117.0214418, 32.5085268),\n",
       " (-117.0065916, 32.5130168),\n",
       " (-116.64, 32.5722),\n",
       " (-116.976212, 32.462053000000004),\n",
       " (-117.056, 32.3422),\n",
       " (-117.053015, 32.334781),\n",
       " (-117.01133, 32.535839),\n",
       " (-116.858, 32.5106),\n",
       " (-116.628297, 32.574929499999996),\n",
       " (-117.0417967, 32.4870803),\n",
       " (-117.044, 32.5347),\n",
       " (-116.8901992, 32.5218671),\n",
       " (-115.465854, 32.665054999999995),\n",
       " (-117.023593, 32.433957),\n",
       " (-116.926203, 32.478353000000006),\n",
       " (-117.044, 32.5347),\n",
       " (-117.041087, 32.530467),\n",
       " (-117.11997, 32.518645),\n",
       " (-117.047971, 32.407382),\n",
       " (-116.9225571, 32.546758000000004),\n",
       " (-117.015035, 32.537284),\n",
       " (-116.918154, 32.49328),\n",
       " (-116.623741, 32.573976),\n",
       " (-117.038621, 32.529324),\n",
       " (-117.0383908, 32.4889671),\n",
       " (-117.0289957, 32.5306904),\n",
       " (-116.91004, 32.551859),\n",
       " (-116.606, 31.8578),\n",
       " (-115.4725236, 32.664533299999995),\n",
       " (-116.6981023, 31.8958128),\n",
       " (-116.591512, 32.829419),\n",
       " (-116.9809224, 32.5107164),\n",
       " (-115.4727659, 32.638806800000005),\n",
       " (-116.5824, 32.3112),\n",
       " (-116.9388623, 32.5398341),\n",
       " (-116.6146759, 31.85529847),\n",
       " (-116.897545, 32.501896),\n",
       " (-117.0731217, 32.5311423),\n",
       " (-115.4799, 32.6654),\n",
       " (-116.601206, 31.810608000000002),\n",
       " (-116.9551, 32.4919),\n",
       " (-115.5005, 32.6559),\n",
       " (-115.4317, 32.625),\n",
       " (-115.416, 32.6648),\n",
       " (-115.5059, 32.656),\n",
       " (-115.4182, 32.6384),\n",
       " (-115.416, 32.6569),\n",
       " (-115.4521, 32.6483),\n",
       " (-115.358447, 32.559894199999995),\n",
       " (-115.4984371, 32.595316700000005),\n",
       " (-115.4262919, 32.613968),\n",
       " (-116.9309, 32.5445),\n",
       " (-116.9176, 32.4687),\n",
       " (-116.8897, 32.5191),\n",
       " (-116.859, 32.5142),\n",
       " (-117.118754, 32.52863),\n",
       " (-115.50671, 32.621217),\n",
       " (-115.4748596, 32.5889576),\n",
       " (-115.356065, 32.583926899999994),\n",
       " (-116.6314844, 32.565995),\n",
       " (-115.4727307, 32.599528899999996),\n",
       " (-115.4639154, 32.606534),\n",
       " (-115.4345754, 32.5856263),\n",
       " (-115.4757, 32.6656),\n",
       " (-116.932687, 32.492119300000006),\n",
       " (-115.4642692, 32.6610423),\n",
       " (-114.8394962, 31.024549100000005),\n",
       " (-116.73429, 32.51193),\n",
       " (-117.09053, 32.533640000000005),\n",
       " (-117.0122977, 32.4432513),\n",
       " (-117.03941, 32.44252),\n",
       " (-116.82773, 32.48982),\n",
       " (-116.95329, 32.432809999999996),\n",
       " (-116.94453, 32.486670000000004),\n",
       " (-116.74069, 32.507540000000006),\n",
       " (-117.040071, 32.438162),\n",
       " (-117.038604, 32.4401476),\n",
       " (-116.81901, 32.48568),\n",
       " (-116.9677, 32.49778),\n",
       " (-116.8357488, 32.4925102),\n",
       " (-116.82297, 32.46167),\n",
       " (-117.03941, 32.44252),\n",
       " (-117.07448, 32.52361),\n",
       " (-117.04206, 32.43287),\n",
       " (-116.7346251, 32.5118043),\n",
       " (-115.99184, 30.733309999999996),\n",
       " (-116.91908, 32.22576),\n",
       " (-115.93069, 30.523529999999997),\n",
       " (-116.57553, 31.855059999999998),\n",
       " (-116.06309, 30.84239),\n",
       " (-116.59966, 31.826209999999996),\n",
       " (-116.59692, 31.814420000000002),\n",
       " (-116.93204005733098, 32.491870559655105),\n",
       " (-116.651374, 32.563998),\n",
       " (-115.41352, 32.655007),\n",
       " (-116.889551, 32.501464),\n",
       " (-117.041841, 32.534901),\n",
       " (-115.4479817, 32.636591100000004),\n",
       " (-115.371851, 32.613819),\n",
       " (-116.962862, 32.497017),\n",
       " (-115.483603, 32.6044916),\n",
       " (-116.56259, 31.7046),\n",
       " (-116.57914, 31.730620000000002),\n",
       " (-116.60124, 31.87507),\n",
       " (-116.60633, 31.86947),\n",
       " (-116.60633, 31.86947),\n",
       " (-116.60399, 31.879340000000003),\n",
       " (-116.60399, 31.879340000000003),\n",
       " (-116.61069, 31.88267),\n",
       " (-116.60493, 31.860529999999997),\n",
       " (-116.59314, 31.86236),\n",
       " (-116.582517, 31.864539),\n",
       " (-116.58655, 31.79032),\n",
       " (-116.59156, 31.853009999999998),\n",
       " (-116.60574, 31.832590000000003),\n",
       " (-116.61238, 31.86249),\n",
       " (-116.61238, 31.86249),\n",
       " (-116.62121, 31.865809999999996),\n",
       " (-116.62493, 31.8683),\n",
       " (-116.62511, 31.880509999999997),\n",
       " (-116.62365, 31.866709999999998),\n",
       " (-116.62121, 31.865809999999996),\n",
       " (-116.62675, 31.87753),\n",
       " (-116.606057, 31.855801),\n",
       " (-116.57513, 31.87725),\n",
       " (-116.58278, 31.89309),\n",
       " (-116.59499, 31.90304),\n",
       " (-115.49212, 32.661640000000006),\n",
       " (-115.49347, 32.663470000000004),\n",
       " (-115.47115, 32.63834),\n",
       " (-115.44033, 32.61397),\n",
       " (-115.45276, 32.64775),\n",
       " (-115.35294, 32.56805),\n",
       " (-115.3371, 32.5651),\n",
       " (-115.47937, 32.61673),\n",
       " (-115.48165, 32.62355),\n",
       " (-115.472478, 32.613815),\n",
       " (-115.47189, 32.60389),\n",
       " (-115.47925, 32.607859999999995),\n",
       " (-115.47294, 32.5859),\n",
       " (-115.43532, 32.625),\n",
       " (-115.42235, 32.62484),\n",
       " (-115.38714, 32.635220000000004),\n",
       " (-115.38736, 32.62311),\n",
       " (-115.48145, 32.59352),\n",
       " (-115.44061, 32.58676),\n",
       " (-115.38885, 32.599340000000005),\n",
       " (-115.384869, 32.609032),\n",
       " (-115.39465, 32.589620000000004),\n",
       " (-115.49815, 32.656040000000004),\n",
       " (-115.50599, 32.6499),\n",
       " (-114.99838, 32.57025),\n",
       " (-115.50557, 32.64399),\n",
       " (-115.52014, 32.64444),\n",
       " (-115.52448, 32.62214),\n",
       " (-115.50566, 32.63046),\n",
       " (-115.50171, 32.62358),\n",
       " (-115.50171, 32.62358),\n",
       " (-115.51509, 32.62143),\n",
       " (-115.43758, 32.66319),\n",
       " (-115.4524, 32.66209),\n",
       " (-115.42128, 32.66409),\n",
       " (-115.4242, 32.65898),\n",
       " (-115.43718, 32.6392),\n",
       " (-115.44619, 32.63026),\n",
       " (-115.42327, 32.63259),\n",
       " (-114.731, 32.715759999999996),\n",
       " (-116.63435, 32.57301),\n",
       " (-116.62338, 32.57403),\n",
       " (-116.63188, 32.5667),\n",
       " (-116.63089, 32.55695),\n",
       " (-116.94354, 32.404579999999996),\n",
       " (-116.93915, 32.386990000000004),\n",
       " (-116.93915, 32.386990000000004),\n",
       " (-116.96597, 32.410759999999996),\n",
       " (-116.96494, 32.424890000000005),\n",
       " (-116.96989, 32.421040000000005),\n",
       " (-116.92856, 32.491009999999996),\n",
       " (-116.860526, 32.494935999999996),\n",
       " (-116.8538, 32.489909999999995),\n",
       " (-116.84929, 32.48429),\n",
       " (-116.87419, 32.46728),\n",
       " (-116.880227, 32.46097),\n",
       " (-116.86009, 32.47361),\n",
       " (-116.86448, 32.47364),\n",
       " (-116.79092, 32.47423),\n",
       " (-116.82766, 32.45824),\n",
       " (-116.91923, 32.53751),\n",
       " (-116.96986, 32.49998),\n",
       " (-117.11595, 32.52478),\n",
       " (-116.86939, 32.51352),\n",
       " (-117.11253, 32.52865),\n",
       " (-117.11436, 32.53306),\n",
       " (-117.12025, 32.511379999999996),\n",
       " (-117.12025, 32.511379999999996),\n",
       " (-116.96422, 32.49765),\n",
       " (-117.0415, 32.490629999999996),\n",
       " (-117.03852, 32.5017),\n",
       " (-117.0321, 32.49633),\n",
       " (-117.03584, 32.48157),\n",
       " (-117.03281, 32.48663),\n",
       " (-117.01226, 32.443259999999995),\n",
       " (-117.01663, 32.44716),\n",
       " (-117.01663, 32.44716),\n",
       " (-117.02411, 32.43399),\n",
       " (-117.03162, 32.43442),\n",
       " (-116.94966, 32.47137),\n",
       " (-117.05759, 32.34319),\n",
       " (-117.052962, 32.399508000000004),\n",
       " (-117.0478, 32.40766),\n",
       " (-117.0478, 32.40766),\n",
       " (-117.050221, 32.365887),\n",
       " (-117.04504, 32.34726),\n",
       " (-117.05958, 32.36339),\n",
       " (-117.05418, 32.36548),\n",
       " (-117.05418, 32.36548),\n",
       " (-117.05942, 32.35366),\n",
       " (-109.92589, 22.8962),\n",
       " (-109.912534, 22.888714),\n",
       " (-109.93872, 22.89462),\n",
       " (-109.93151, 22.9035),\n",
       " (-90.53413, 19.84208),\n",
       " (-90.5369, 19.84497),\n",
       " (-91.83196, 18.64241),\n",
       " (-91.83469, 18.63702),\n",
       " (-91.83783, 18.6407),\n",
       " (-100.93591, 29.324240000000003),\n",
       " (-100.93244, 29.321959999999997),\n",
       " (-100.930569, 29.309534000000003),\n",
       " (-101.4618, 26.92735),\n",
       " (-101.41897, 26.90198),\n",
       " (-101.41762, 26.900059999999996),\n",
       " (-101.41517, 26.898059999999997),\n",
       " (-101.41242, 26.95096),\n",
       " (-101.41168, 26.909000000000002),\n",
       " (-101.43846, 26.90151),\n",
       " (-101.42418, 26.89033),\n",
       " (-100.51519, 28.703490000000002),\n",
       " (-104.318106, 19.050689000000002),\n",
       " (-104.339869, 19.12302),\n",
       " (-103.87279, 18.91186),\n",
       " (-103.87283, 18.910079999999997),\n",
       " (-103.74043, 19.263820000000003),\n",
       " (-92.80831, 16.552770000000002),\n",
       " (-92.80533, 16.5543),\n",
       " (-93.900285, 16.233103),\n",
       " (-93.89873, 16.23517),\n",
       " (-92.16728, 14.990820000000001),\n",
       " (-92.16499, 14.99576),\n",
       " (-92.13546, 16.25072),\n",
       " (-92.1406, 15.66063),\n",
       " (-93.65039, 16.668020000000002),\n",
       " (-91.98181, 16.317320000000002),\n",
       " (-91.98136, 16.31685),\n",
       " (-92.2475, 15.3639),\n",
       " (-93.37598, 16.7619),\n",
       " (-93.37323, 16.76153),\n",
       " (-93.33552, 17.4055),\n",
       " (-92.34259, 16.7835),\n",
       " (-91.98206, 17.509120000000003),\n",
       " (-91.98489, 17.5091),\n",
       " (-93.11728, 17.511039999999998),\n",
       " (-93.20896, 15.686951),\n",
       " (-93.2076, 15.6877),\n",
       " (-92.63804, 16.736620000000002),\n",
       " (-92.63804, 16.736620000000002),\n",
       " (-92.63509, 16.74474),\n",
       " (-92.63509, 16.74474),\n",
       " (-92.63744, 16.74324),\n",
       " (-92.63744, 16.74324),\n",
       " (-92.638024, 16.74028),\n",
       " (-92.649961, 16.738344),\n",
       " (-92.64749, 16.73519),\n",
       " (-92.65436, 16.7502),\n",
       " (-92.636873, 16.7203),\n",
       " (-92.14971, 14.6803),\n",
       " (-92.26435, 14.91186),\n",
       " (-92.26545, 14.910479999999998),\n",
       " (-92.26663, 14.91736),\n",
       " (-92.26239, 14.90581),\n",
       " (-92.26783, 14.899370000000001),\n",
       " (-92.26485, 14.911760000000001),\n",
       " (-92.25901, 14.91407),\n",
       " (-92.26257, 14.90882),\n",
       " (-92.26257, 14.90882),\n",
       " (-92.26097, 14.8986),\n",
       " (-92.260557, 14.918469),\n",
       " (-92.25388, 14.92487),\n",
       " (-92.2549, 14.886420000000001),\n",
       " (-92.263152, 14.876064999999999),\n",
       " (-92.251372, 14.879133),\n",
       " (-92.29517, 14.89081),\n",
       " (-92.422488, 14.717817000000002),\n",
       " (-93.18426, 16.76418),\n",
       " (-92.56396, 16.33995),\n",
       " (-92.45023, 16.27828),\n",
       " (-93.26694, 16.23481),\n",
       " (-105.91261, 28.8372),\n",
       " (-105.17261, 27.69547),\n",
       " (-105.166188, 27.686519),\n",
       " (-106.86304, 28.403840000000002),\n",
       " (-106.8632, 28.40881),\n",
       " (-106.86891, 28.40748),\n",
       " (-106.86938, 28.40424),\n",
       " (-106.86739, 28.40803),\n",
       " (-106.90763, 28.75143),\n",
       " (-106.02642, 28.61781),\n",
       " (-106.13549, 28.64852),\n",
       " (-106.132857, 28.690548),\n",
       " (-106.15182, 28.711270000000003),\n",
       " (-106.14198, 28.68443),\n",
       " (-106.12082, 28.725959999999997),\n",
       " (-106.11366, 28.729540000000004),\n",
       " (-106.127655, 28.723726),\n",
       " (-106.08067, 28.679000000000002),\n",
       " (-106.12341, 28.739490000000004),\n",
       " (-106.1678, 28.776999999999997),\n",
       " (-105.98325, 28.66945),\n",
       " (-106.09347, 28.60365),\n",
       " (-107.48109, 28.547279999999997),\n",
       " (-105.66491, 26.93313),\n",
       " (-105.67035, 26.927629999999997),\n",
       " (-105.66818, 26.936290000000003),\n",
       " (-105.669, 26.9332),\n",
       " (-105.6804, 26.93198),\n",
       " (-104.92295, 27.129640000000002),\n",
       " (-104.91294, 27.125009999999996),\n",
       " (-104.90589, 27.122640000000004),\n",
       " (-106.4819, 31.745309999999996),\n",
       " (-106.48579, 31.743370000000002),\n",
       " (-116.6594, 31.8662),\n",
       " (-116.5782, 31.8953),\n",
       " (-116.5797, 31.8541),\n",
       " (-115.4697, 32.641999999999996),\n",
       " (-115.4764, 32.5942),\n",
       " (-116.9515, 32.5307),\n",
       " (-117.0227, 32.5245),\n",
       " (-116.9786, 32.5287),\n",
       " (-116.8739, 32.4754),\n",
       " (-117.0412, 32.4362),\n",
       " (-116.966, 32.4807),\n",
       " (-116.9144, 32.5102),\n",
       " (-116.865, 32.5134),\n",
       " (-116.95, 32.4715),\n",
       " (-116.8982, 32.5008),\n",
       " (-116.926, 32.4603),\n",
       " (-116.993, 32.4765),\n",
       " (-117.006593, 32.512701),\n",
       " (-116.962069, 32.519296999999995),\n",
       " (-116.605433, 31.83227),\n",
       " (-115.4497, 32.6572),\n",
       " (-116.607587, 31.864272999999997),\n",
       " (-115.4952, 32.6231),\n",
       " (-116.6248398, 31.8694656),\n",
       " (-116.6073, 31.8506),\n",
       " (-115.467564, 32.648739899999995),\n",
       " (-117.020809, 32.524634999999996),\n",
       " (-116.940884, 32.5453414),\n",
       " (-115.453606, 32.662075),\n",
       " (-116.614667, 31.858417),\n",
       " (-115.375387, 32.65614),\n",
       " (-115.478783, 32.665227),\n",
       " (-115.452338, 32.6481946),\n",
       " (-115.472213, 32.650911),\n",
       " (-115.44461, 32.638040999999994),\n",
       " (-115.466981, 32.636671),\n",
       " (-115.385637, 32.636644),\n",
       " (-115.444841, 32.626616999999996),\n",
       " (-115.47669, 32.624057),\n",
       " (-115.49744, 32.624053),\n",
       " (-115.509155, 32.623247),\n",
       " (-115.479482, 32.615526),\n",
       " (-115.372004, 32.601114),\n",
       " (-116.9279, 32.5078),\n",
       " (-115.46037, 32.647123),\n",
       " (-116.991148, 32.528283),\n",
       " (-116.9702, 32.501306),\n",
       " (-117.014112, 32.536596),\n",
       " (-116.948993, 32.4881176),\n",
       " (-114.9676, 32.5461),\n",
       " (-117.038523, 32.536190999999995),\n",
       " (-117.027507, 32.525073),\n",
       " (-117.009237, 32.524663000000004),\n",
       " (-117.07295, 32.531242),\n",
       " (-116.923141, 32.486084999999996),\n",
       " (-117.0208921, 32.5166965),\n",
       " (-116.9700701, 32.497496000000005),\n",
       " (-117.05984, 32.353695),\n",
       " (-116.8968909, 32.5120592),\n",
       " (-116.95356, 32.5048137),\n",
       " (-116.975832, 32.504757),\n",
       " (-117.0594424, 32.364621299999996),\n",
       " (-116.8968903, 32.5120587),\n",
       " (-117.1152234, 32.5313536),\n",
       " (-116.9728304, 32.509256699999995),\n",
       " (-116.8863831, 32.5008657),\n",
       " (-116.9299859, 32.544581),\n",
       " (-116.9647032, 32.5020788),\n",
       " (-116.9331198, 32.470130499999996),\n",
       " (-115.387952, 32.62867),\n",
       " (-115.43427, 32.624528000000005),\n",
       " (-115.385692, 32.635526),\n",
       " (-116.96505517, 32.50546046),\n",
       " (-115.4894048, 32.6621939),\n",
       " (-115.467377, 32.5913734),\n",
       " (-115.4013556, 32.65279167),\n",
       " (-117.00473, 32.468313),\n",
       " (-116.6003, 31.8398),\n",
       " (-115.386394, 32.614812),\n",
       " (-117.025656, 32.52272),\n",
       " (-116.600282, 31.825117),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-115.987797, 30.708721),\n",
       " (-116.6303, 31.8823),\n",
       " (-116.607998, 31.891121000000002),\n",
       " (-116.5739458, 31.8944374),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.566314, 31.878347899999998),\n",
       " (-116.5767355, 31.8523901),\n",
       " (-116.588352, 31.887308),\n",
       " (-116.615211, 31.861965),\n",
       " (-113.5611, 28.9481),\n",
       " (-114.641, 30.3519),\n",
       " (-116.3753565, 31.2752533),\n",
       " (-116.5766, 32.0932),\n",
       " (-115.1935, 28.0938),\n",
       " (-116.572713, 31.719590999999998),\n",
       " (-116.851257, 32.093387),\n",
       " (-116.26981, 31.910308),\n",
       " (-115.723506, 30.060498),\n",
       " (-116.134011, 30.925473999999998),\n",
       " (-116.247211, 31.327671999999996),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.987797, 30.708721),\n",
       " (-116.6519, 31.966977000000004),\n",
       " (-116.0521, 30.8511),\n",
       " (-115.542, 31.3291),\n",
       " (-115.890043, 31.610915000000002),\n",
       " (-115.882997, 30.428326000000002),\n",
       " (-115.824, 31.6493),\n",
       " (-115.737995, 31.402612),\n",
       " (-116.010411, 30.765902),\n",
       " (-116.061, 31.096),\n",
       " (-116.511, 31.6729),\n",
       " (-116.514683, 31.672760999999998),\n",
       " (-115.9162334, 30.5086267),\n",
       " (-116.003, 30.7017),\n",
       " (-115.476271, 32.644334),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-115.440302, 32.623859),\n",
       " (-115.440302, 32.623859),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-115.376578, 32.662116999999995),\n",
       " (-115.5008223, 32.642084999999994),\n",
       " (-115.4033032, 32.662886199999996),\n",
       " (-115.507579, 32.610863),\n",
       " (-115.4452058, 32.6103206),\n",
       " (-115.4202195, 32.6209859),\n",
       " (-115.405299, 32.573715),\n",
       " (-115.430153, 32.5834905),\n",
       " (-115.5226366, 32.653505800000005),\n",
       " (-115.5161416, 32.636992600000006),\n",
       " (-115.4324397, 32.644703),\n",
       " (-115.3911848, 32.603462699999994),\n",
       " (-115.467173, 32.651136),\n",
       " (-115.167146, 32.232315),\n",
       " (-114.7325261, 32.7168679),\n",
       " (-115.1973577, 32.3561625),\n",
       " (-115.256147, 32.249817),\n",
       " (-115.103287, 32.288610999999996),\n",
       " (-115.141, 32.3958),\n",
       " (-114.923258, 32.511733),\n",
       " (-114.854, 32.5272),\n",
       " (-114.84337, 32.635998),\n",
       " (-115.1912281, 32.409107899999995),\n",
       " (-115.08241, 32.430134),\n",
       " (-115.5837158, 32.582695199999996),\n",
       " (-115.3500466, 32.572133799999996),\n",
       " (-115.1442021, 32.549313899999994),\n",
       " (-114.839587, 31.0232256),\n",
       " (-115.5756665, 32.6298608),\n",
       " (-115.233854, 32.288619),\n",
       " (-115.412739, 32.52878),\n",
       " (-115.068, 32.3423),\n",
       " (-115.0002, 32.57),\n",
       " (-115.003, 32.193000000000005),\n",
       " (-114.986751, 32.027793),\n",
       " (-115.074533, 32.397907000000004),\n",
       " (-116.632415, 32.557444),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.047287, 32.541286),\n",
       " (-116.619738, 32.370171),\n",
       " (-116.307203, 32.505542),\n",
       " (-116.570838, 32.490109999999994),\n",
       " (-117.009698, 32.525583000000005),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-117.039, 32.5351),\n",
       " (-117.044, 32.5347),\n",
       " (-116.960202, 32.422201),\n",
       " (-117.099874, 32.524682),\n",
       " (-116.957052, 32.466407000000004),\n",
       " (-116.892, 32.5527),\n",
       " (-116.875192, 32.479487),\n",
       " (-116.881002, 32.540312),\n",
       " (-116.967958, 32.495079),\n",
       " (-117.064759, 32.529181),\n",
       " (-117.083005, 32.51471),\n",
       " (-116.9356023, 32.5234765),\n",
       " (-116.877305, 32.505208),\n",
       " (-116.9380942, 32.4600199),\n",
       " (-116.79313, 32.504671),\n",
       " (-116.9896964, 32.5339425),\n",
       " (-117.077807, 32.483140999999996),\n",
       " (-116.881216, 32.476085600000005),\n",
       " (-116.9761128, 32.4746588),\n",
       " (-117.059844, 32.487771),\n",
       " (-116.9706684, 32.4678683),\n",
       " (-116.918273, 32.455237),\n",
       " (-116.8562615, 32.4757522),\n",
       " (-116.8736545, 32.5188985),\n",
       " (-116.989345, 32.451409999999996),\n",
       " (-117.0373777, 32.4786766),\n",
       " (-117.0556442, 32.5107552),\n",
       " (-116.933912, 32.541612300000004),\n",
       " (-117.038, 32.5275),\n",
       " (-116.789997, 32.47161),\n",
       " (-116.90936, 32.463079),\n",
       " (-116.9096, 32.4632),\n",
       " (-117.063, 32.3588),\n",
       " (-117.0459362, 32.405593599999996),\n",
       " (-116.9171232, 32.221545899999995),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.6424915, 32.5703617),\n",
       " (-116.882, 32.4911),\n",
       " (-117.0563014, 32.3633358),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-115.440302, 32.623859),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-115.440302, 32.623859),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.423, 31.5839),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-115.989164, 30.726204),\n",
       " (-116.003, 30.7017),\n",
       " (-115.987797, 30.708721),\n",
       " (-116.438, 31.6242),\n",
       " (-115.989164, 30.726204),\n",
       " (-116.557301, 32.105464000000005),\n",
       " (-116.848846, 32.471906),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.0648, 30.8368),\n",
       " (-115.440302, 32.623859),\n",
       " (-116.9096, 32.4632),\n",
       " (-117.0341, 32.4749),\n",
       " (-116.5949, 31.8278),\n",
       " (-115.3769, 32.6258),\n",
       " (-116.9864, 32.4842),\n",
       " (-115.4742, 32.6435),\n",
       " (-116.92895, 32.489581),\n",
       " (-115.4716942, 32.6426279),\n",
       " (-116.596183, 31.808909999999997),\n",
       " (-116.9829974, 32.50851289999999),\n",
       " (-115.066611, 32.241991999999996),\n",
       " (-115.474344, 32.639472999999995),\n",
       " (-115.468, 32.6633),\n",
       " (-117.039, 32.5351),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.3500466, 32.572133799999996),\n",
       " (-116.972, 32.4925),\n",
       " (-116.605, 31.8336),\n",
       " (-115.48115, 32.6557),\n",
       " (-117.044, 32.5347),\n",
       " (-116.605, 31.8336),\n",
       " (-116.544156, 31.879974),\n",
       " (-117.0554, 32.3636),\n",
       " (-116.6881196, 31.8906529),\n",
       " (-116.967766, 32.461939),\n",
       " (-116.58169, 31.780928999999997),\n",
       " (-116.64255, 31.706039),\n",
       " (-116.581502, 31.780963),\n",
       " (-115.523, 32.5383),\n",
       " (-115.2474, 32.3142),\n",
       " (-115.419286, 32.6210146),\n",
       " (-116.158006, 30.969621999999998),\n",
       " (-115.943267, 30.523799),\n",
       " (-115.467173, 32.651136),\n",
       " (-115.5616419, 32.6346226),\n",
       " (-116.59792, 31.782227000000002),\n",
       " (-117.05549, 32.51072),\n",
       " (-117.0429, 32.3725),\n",
       " (-116.825954, 32.49136),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.477, 32.6382),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-117.010025, 32.52661),\n",
       " (-116.61981, 31.8763),\n",
       " (-116.620663, 31.876346999999996),\n",
       " (-116.620107, 31.876519300000002),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-116.9096, 32.4632),\n",
       " (-115.068807, 32.348993),\n",
       " (-116.9096, 32.4632),\n",
       " (-115.440302, 32.623859),\n",
       " (-116.9096, 32.4632),\n",
       " (-117.090248, 32.487792999999996),\n",
       " (-115.440302, 32.623859),\n",
       " (-117.0089, 32.5256),\n",
       " (-116.592991, 31.89651),\n",
       " (-116.592992, 31.896511),\n",
       " (-116.589384, 32.563482),\n",
       " (-116.9096, 32.4632),\n",
       " (-114.995522, 32.189066),\n",
       " (-115.3756, 32.6239),\n",
       " (-115.4206506, 32.6026524),\n",
       " (-115.4403, 32.624340000000004),\n",
       " (-116.90936, 32.463079),\n",
       " (-115.5607433, 32.6338344),\n",
       " (-115.3754243, 32.6244797),\n",
       " (-115.5616419, 32.6346226),\n",
       " (-115.5161416, 32.636992600000006),\n",
       " (-115.3933627, 32.6032515),\n",
       " (-115.4054, 32.57393478),\n",
       " (-115.473, 32.6372),\n",
       " (-116.6233194, 32.5742965),\n",
       " (-116.938, 32.4765),\n",
       " (-117.066, 32.5217),\n",
       " (-117.028, 32.5264),\n",
       " (-116.873, 32.519),\n",
       " (-117.057, 32.3422),\n",
       " (-117.0520555, 32.3612909),\n",
       " (-116.6878571, 31.89078512),\n",
       " (-116.572714, 31.719592),\n",
       " (-116.597003, 31.782325),\n",
       " (-116.6157597, 31.8616717),\n",
       " (-115.994, 30.7303),\n",
       " (-115.503, 32.6634),\n",
       " (-117.03782, 32.527386),\n",
       " (-115.478934, 32.638586),\n",
       " (-115.987797, 30.708721),\n",
       " (-115.987797, 30.708721),\n",
       " (-117.060862, 32.397420000000004)]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Creación de geodataframe\n",
    "gdf = gpd.GeoDataFrame(\n",
    "    clues, geometry=gpd.points_from_xy(clues.longitude, clues.latitude))\n",
    "\n",
    "#Convirtiendo puntos geográficos\n",
    "points=gpd.points_from_xy(clues.longitude, clues.latitude)\n",
    "\n",
    "#Creación de coordenadas de cada centro de salud (clues)\n",
    "coord_list = [(x,y) for x,y in zip(gdf['geometry'].x , gdf['geometry'].y)]\n",
    "coord_list\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "5fc71a19006642ce9e2d935e2cfeab39",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Map(center=[32.5027, -117.00371], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', …"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Visualización de diagrama de voronoi\n",
    "\n",
    "points = coord_list\n",
    "result = voronoi(points)\n",
    "\n",
    "m = Map(center=[32.5027, -117.00371], zoom=4)\n",
    "\n",
    "for point in points:\n",
    "    marker = Marker(location=[point[1], point[0]])\n",
    "    m.add_layer(marker)\n",
    "\n",
    "vor = GeoJSON(name=\"Original\", data=result, style={\"color\": \"red\"})\n",
    "m.add_layer(vor)\n",
    "m"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En el mapa anterior, se puede observar la densidad de las ubicaciones de los centros de salud en Baja California, así como las áreas geográficas en donde el centro de salud más cercano es remoto (las celdas más grandes), mientras que existen áreas en donde se encuentran más opciones.\n",
    "\n",
    "Otra de las observaciones es la calidad de los datos. Se debe realizar un filtro con mayor detalle (no incluido en este ejercicio de prueba de concepto) que excluya del mapa todos aquellos puntos geográficos que no correspondan con la localidad que se está trabajando, en este caso es Baja California."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Análisis de atención por densidad poblacional"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Tras realizar el diagrama de Voronoi para ubicar las áreas cercanas a cada centro de salud, se debe realizar el cruce con la densidad poblacional de la región que se está estudiando con el fin de identificar aquellas zonas que carecen de la debida oferta de servicios de salud.\n",
    "\n",
    "Para realizar este análisis se tuvo que realizar una normalización de los datos de población, ya que en la base de datos de ITER (censo de población por localidad), los puntos geográficos se mostraban uno por localidad o municipio. Esto puede dar la impresión de que, en una zona muy poblada, toda la densidad poblacional esté concentrada en un solo punto, como fue en el caso de Tijuana (noroeste de Baja California).\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Importar datos de población de Baja California\n",
    "df_pob=pd.read_csv('https://storage.googleapis.com/hdsp-data/BCpob01.csv')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ENTIDAD</th>\n",
       "      <th>MUN</th>\n",
       "      <th>LONGITUD</th>\n",
       "      <th>LATITUD</th>\n",
       "      <th>POBTOT</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>-116.595134</td>\n",
       "      <td>31.808944</td>\n",
       "      <td>330652</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>-116.052692</td>\n",
       "      <td>31.593772</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>-116.319052</td>\n",
       "      <td>31.960204</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>-116.662460</td>\n",
       "      <td>31.536896</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>-116.265246</td>\n",
       "      <td>31.267510</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   ENTIDAD  MUN    LONGITUD    LATITUD  POBTOT\n",
       "0        2    1 -116.595134  31.808944  330652\n",
       "1        2    1 -116.052692  31.593772       6\n",
       "2        2    1 -116.319052  31.960204       5\n",
       "3        2    1 -116.662460  31.536896       2\n",
       "4        2    1 -116.265246  31.267510       2"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Eliminar las filas que no contienen valores dentro de las variables necesarias\n",
    "df_pob=df_pob.dropna(axis='index', how='any', subset= ['LATITUD', 'LONGITUD'])\n",
    "\n",
    "\n",
    "#Crear dataframe con variables necesarias para el análisis\n",
    "df_pob=df_pob[['ENTIDAD', 'MUN', 'LONGITUD', 'LATITUD', 'POBTOT']]\n",
    "\n",
    "df_pob.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Normalización de población por cada punto geográfico\n",
    "\n",
    "# por cada mil personas\n",
    "df_pob['POBTOT100'] = df_pob['POBTOT'] / 1000\n",
    "#redondeo hacía arriba y convierto en entero\n",
    "df_pob['POBTOT100'] = df_pob['POBTOT100'].apply(np.ceil).astype('int')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "numberOfPoblacion = list(df_pob['POBTOT100'])\n",
    "for number in range(len(numberOfPoblacion)):\n",
    "    for i in range(numberOfPoblacion[number]):\n",
    "        df_pob = df_pob.append(df_pob.iloc[[number]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Creación de geodataframe\n",
    "geopob = gpd.GeoDataFrame(\n",
    "    df_pob, geometry=gpd.points_from_xy(df_pob.LONGITUD, df_pob.LATITUD))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(-116.59513390000002, 31.80894389),\n",
       " (-116.0526922, 31.59377194),\n",
       " (-116.31905220000002, 31.96020389),\n",
       " (-116.66246029999999, 31.53689639),\n",
       " (-116.2652456, 31.267509999999998),\n",
       " (-116.0382644, 31.27332417),\n",
       " (-116.2637064, 31.94297361),\n",
       " (-116.76264609999998, 32.00398944),\n",
       " (-116.52215859999998, 31.642390000000002),\n",
       " (-116.1294364, 31.23685611),\n",
       " (-116.37139499999999, 31.27332361),\n",
       " (-116.12064309999998, 31.09147722),\n",
       " (-116.5795778, 32.09698472),\n",
       " (-116.1544439, 30.97133556),\n",
       " (-116.1327189, 31.9345175),\n",
       " (-116.2625222, 31.2956325),\n",
       " (-115.19277779999999, 28.09555556),\n",
       " (-116.8549622, 32.02642611),\n",
       " (-116.73548219999999, 31.95981778),\n",
       " (-116.1788625, 31.1028625),\n",
       " (-116.57149059999999, 31.72355083),\n",
       " (-116.20726470000001, 31.339692499999998),\n",
       " (-116.54325109999999, 32.08848444),\n",
       " (-116.43190609999999, 31.34757333),\n",
       " (-116.8509456, 32.09341167),\n",
       " (-116.6121278, 31.711625),\n",
       " (-116.64121829999999, 31.99371778),\n",
       " (-116.4700675, 31.895305),\n",
       " (-116.27038470000001, 31.33075556),\n",
       " (-115.7141267, 31.36336083),\n",
       " (-116.6409689, 31.705227500000003),\n",
       " (-116.21029920000001, 31.07036056),\n",
       " (-116.31284440000002, 31.98814667),\n",
       " (-116.2709956, 31.91009111),\n",
       " (-116.3483006, 32.00006167),\n",
       " (-116.26260309999999, 31.32017861),\n",
       " (-116.2121447, 31.20900556),\n",
       " (-116.2146144, 31.29103056),\n",
       " (-116.15910530000001, 31.20216972),\n",
       " (-116.2401919, 31.34843944),\n",
       " (-116.14432109999998, 31.87348361),\n",
       " (-116.2100364, 31.23126194),\n",
       " (-116.62814920000001, 32.01218),\n",
       " (-116.52113829999999, 31.91772306),\n",
       " (-116.2389922, 31.21561528),\n",
       " (-116.4068742, 31.55154306),\n",
       " (-116.25033529999999, 31.32662333),\n",
       " (-116.2527628, 31.24507528),\n",
       " (-116.69870309999999, 31.89622056),\n",
       " (-116.7346364, 31.94734056),\n",
       " (-116.4921314, 31.89560583),\n",
       " (-116.5013675, 31.90032806),\n",
       " (-116.3077778, 31.11138889),\n",
       " (-116.65817779999999, 31.96937694),\n",
       " (-116.2532028, 31.00720389),\n",
       " (-115.13555190000001, 30.67165556),\n",
       " (-114.3967192, 29.80179722),\n",
       " (-116.19118999999999, 31.03812417),\n",
       " (-115.9482942, 32.00422139),\n",
       " (-115.88922420000002, 32.03571056),\n",
       " (-116.45183440000001, 31.56471389),\n",
       " (-116.39885859999998, 31.83064611),\n",
       " (-115.9051406, 31.68790944),\n",
       " (-116.25407690000002, 31.29921889),\n",
       " (-116.67473329999999, 31.97266167),\n",
       " (-116.71386470000002, 31.72288667),\n",
       " (-116.26660220000001, 31.94779139),\n",
       " (-116.2525675, 31.91067861),\n",
       " (-116.5908233, 32.08878833),\n",
       " (-116.58679, 31.99234056),\n",
       " (-116.2696869, 31.3558925),\n",
       " (-116.2313028, 31.31754694),\n",
       " (-116.3182283, 31.95347444),\n",
       " (-116.4954564, 32.18464694),\n",
       " (-116.4033256, 31.91717222),\n",
       " (-116.5399478, 31.90729889),\n",
       " (-116.60723670000002, 32.09279083),\n",
       " (-116.5899131, 32.054677500000004),\n",
       " (-116.4166978, 31.71344861),\n",
       " (-116.6647039, 31.95179889),\n",
       " (-116.29331440000001, 31.95909167),\n",
       " (-114.66903810000001, 30.57963194),\n",
       " (-116.165825, 31.25940806),\n",
       " (-116.2424558, 31.30894222),\n",
       " (-116.3448742, 31.99312833),\n",
       " (-116.1458919, 31.25515417),\n",
       " (-116.6427564, 31.65748694),\n",
       " (-116.50111809999999, 31.79767667),\n",
       " (-116.15898190000001, 31.25027444),\n",
       " (-116.202895, 31.94753194),\n",
       " (-116.18834440000002, 31.94522306),\n",
       " (-115.5435825, 31.32949139),\n",
       " (-116.5860753, 32.07597778),\n",
       " (-115.76280359999998, 31.26661889),\n",
       " (-116.3240131, 31.36460194),\n",
       " (-114.63118359999999, 30.12362861),\n",
       " (-116.3611808, 31.64271944),\n",
       " (-116.21476670000001, 31.93440611),\n",
       " (-115.8937719, 31.61248889),\n",
       " (-116.4863494, 32.19537667),\n",
       " (-116.67692439999999, 31.97673278),\n",
       " (-116.2923031, 31.98074583),\n",
       " (-115.8184869, 31.54022528),\n",
       " (-114.7020558, 30.81707222),\n",
       " (-115.8143767, 31.52855611),\n",
       " (-116.5515872, 32.09183806),\n",
       " (-116.39572779999999, 31.91493167),\n",
       " (-115.16944309999998, 30.81327583),\n",
       " (-116.6226642, 31.97894778),\n",
       " (-116.1253767, 31.92460361),\n",
       " (-116.54803170000001, 32.08816806),\n",
       " (-116.2602456, 31.82291639),\n",
       " (-116.4532969, 31.35510472),\n",
       " (-115.8196767, 31.52478972),\n",
       " (-116.6024594, 32.03558778),\n",
       " (-116.16563059999999, 31.95866333),\n",
       " (-116.6224969, 32.07174611),\n",
       " (-116.24336170000001, 31.33989472),\n",
       " (-114.3090344, 29.74035222),\n",
       " (-116.5169581, 31.65689333),\n",
       " (-116.62327169999999, 32.07765056),\n",
       " (-116.3172544, 31.99361778),\n",
       " (-116.47050420000001, 31.63631639),\n",
       " (-116.2776011, 31.88529583),\n",
       " (-116.4398517, 31.32724056),\n",
       " (-116.447025, 31.34528861),\n",
       " (-116.0029728, 31.65426472),\n",
       " (-115.86861110000001, 31.595),\n",
       " (-116.0531564, 32.21777139),\n",
       " (-116.6248311, 31.68560111),\n",
       " (-116.63718329999999, 31.70206278),\n",
       " (-115.9802778, 31.97972222),\n",
       " (-114.70704109999998, 30.71064111),\n",
       " (-116.2032919, 31.35876583),\n",
       " (-116.25106470000001, 31.34083167),\n",
       " (-115.8965486, 32.03203111),\n",
       " (-115.83552639999999, 31.56335278),\n",
       " (-116.5407969, 31.67275639),\n",
       " (-116.6689628, 31.98462556),\n",
       " (-116.3111797, 31.96540972),\n",
       " (-116.59613190000002, 32.080999999999996),\n",
       " (-116.5874058, 32.08879639),\n",
       " (-116.5484919, 32.11574889),\n",
       " (-116.38873059999999, 31.54327833),\n",
       " (-116.40258610000001, 31.28922778),\n",
       " (-116.6316486, 32.10272778),\n",
       " (-116.37827220000001, 31.63397056),\n",
       " (-116.4561325, 31.71253528),\n",
       " (-116.1409639, 31.25368111),\n",
       " (-115.82779140000001, 31.65450833),\n",
       " (-116.4436406, 32.14187028),\n",
       " (-116.6269611, 32.02605056),\n",
       " (-116.42401559999999, 32.17349083),\n",
       " (-116.16670079999999, 32.13268056),\n",
       " (-116.2538664, 31.30857222),\n",
       " (-116.3618472, 31.63823),\n",
       " (-116.52682279999999, 31.91423167),\n",
       " (-116.18916940000001, 31.36241306),\n",
       " (-116.27106780000001, 31.97483833),\n",
       " (-115.8360872, 31.71497778),\n",
       " (-116.29633170000001, 31.97083417),\n",
       " (-115.7777172, 31.38927639),\n",
       " (-116.4306264, 32.12099),\n",
       " (-114.7075969, 30.71829861),\n",
       " (-116.7061686, 31.98953611),\n",
       " (-116.74701609999998, 31.99265694),\n",
       " (-116.8836392, 32.04806306),\n",
       " (-116.77984280000001, 32.03949889),\n",
       " (-116.79417360000001, 32.03748417),\n",
       " (-116.0801294, 31.16263667),\n",
       " (-116.50478170000001, 31.78261167),\n",
       " (-114.64032560000001, 30.35095361),\n",
       " (-116.7066103, 31.97041417),\n",
       " (-116.5961775, 31.69617667),\n",
       " (-116.1761186, 31.086715),\n",
       " (-116.48806809999999, 31.79799861),\n",
       " (-116.1510817, 31.32479611),\n",
       " (-115.7341814, 31.40447806),\n",
       " (-116.43984420000001, 31.62348333),\n",
       " (-115.6908744, 31.422735),\n",
       " (-116.5609419, 31.75730972),\n",
       " (-116.23283670000001, 31.23988222),\n",
       " (-116.4635222, 32.112007500000004),\n",
       " (-116.50314440000001, 32.11085889),\n",
       " (-114.4428981, 29.90727667),\n",
       " (-116.1539775, 30.96655472),\n",
       " (-116.5197183, 32.14266417),\n",
       " (-116.62565749999999, 32.01698),\n",
       " (-116.25468390000002, 31.88404389),\n",
       " (-116.16487579999999, 30.98176028),\n",
       " (-116.6319206, 32.01513806),\n",
       " (-116.59067830000001, 32.08704944),\n",
       " (-116.24828500000001, 31.88790972),\n",
       " (-116.54278970000001, 32.09758694),\n",
       " (-116.5216858, 31.678507500000002),\n",
       " (-115.5797233, 31.33930139),\n",
       " (-115.83442690000001, 31.57115333),\n",
       " (-114.69813559999999, 30.65188556),\n",
       " (-116.5401797, 32.10898889),\n",
       " (-116.88271329999999, 32.04963444),\n",
       " (-116.5255014, 31.67829389),\n",
       " (-116.6558203, 32.06763333),\n",
       " (-116.1587506, 30.969307500000003),\n",
       " (-116.52923, 32.137240000000006),\n",
       " (-116.4891456, 31.886834999999998),\n",
       " (-114.6265611, 30.11819528),\n",
       " (-114.4045525, 29.82698917),\n",
       " (-116.5343856, 32.11242583),\n",
       " (-116.0990953, 31.86147972),\n",
       " (-116.50857690000001, 32.11635361),\n",
       " (-116.6318425, 32.03872778),\n",
       " (-116.5304936, 32.12863056),\n",
       " (-114.6889817, 30.61043472),\n",
       " (-116.1505878, 31.46276778),\n",
       " (-116.66069499999999, 31.71794722),\n",
       " (-115.79328329999998, 31.65504556),\n",
       " (-116.6072372, 31.55295472),\n",
       " (-116.65983359999998, 32.13783694),\n",
       " (-116.4300436, 31.89754111),\n",
       " (-116.5534108, 31.84810111),\n",
       " (-116.33539609999998, 31.53869583),\n",
       " (-116.2715314, 31.53564917),\n",
       " (-115.6442106, 31.26603861),\n",
       " (-116.2515342, 31.92211278),\n",
       " (-116.12635390000001, 31.131657500000003),\n",
       " (-116.64852920000001, 32.05633111),\n",
       " (-116.5200992, 31.90022972),\n",
       " (-116.68453970000002, 31.70332417),\n",
       " (-116.51436580000001, 31.90336778),\n",
       " (-116.5931242, 31.74470556),\n",
       " (-116.22348079999999, 31.29770361),\n",
       " (-116.5096092, 32.15268611),\n",
       " (-114.6986433, 30.7415225),\n",
       " (-116.0817703, 31.90050556),\n",
       " (-116.5332358, 31.44657139),\n",
       " (-116.7465728, 31.98007972),\n",
       " (-116.5145858, 31.85477639),\n",
       " (-114.70500829999999, 30.7208),\n",
       " (-115.91910279999999, 31.92734194),\n",
       " (-116.5891817, 31.55285861),\n",
       " (-116.54725690000001, 31.44799972),\n",
       " (-114.64468500000001, 30.37662806),\n",
       " (-116.4259753, 31.62795889),\n",
       " (-116.60588059999999, 31.72385806),\n",
       " (-116.4981283, 32.10262778),\n",
       " (-116.603945, 32.1115225),\n",
       " (-116.29470719999999, 31.44657917),\n",
       " (-116.2450939, 31.25685444),\n",
       " (-114.6332225, 30.41879917),\n",
       " (-114.57743810000001, 30.04032),\n",
       " (-116.3220397, 31.29522417),\n",
       " (-115.7357053, 31.37331944),\n",
       " (-116.6074211, 31.74348167),\n",
       " (-114.65250139999999, 30.27498139),\n",
       " (-116.13381000000001, 31.91635917),\n",
       " (-114.65016750000001, 30.52944639),\n",
       " (-114.65527309999999, 30.28843472),\n",
       " (-116.67264579999998, 31.89570361),\n",
       " (-116.5013436, 31.84822389),\n",
       " (-114.6400042, 30.36378083),\n",
       " (-116.410605, 31.5196025),\n",
       " (-115.62998940000001, 31.38343861),\n",
       " (-114.47893640000001, 29.92741889),\n",
       " (-114.70511940000002, 30.70434194),\n",
       " (-116.2784842, 31.96530056),\n",
       " (-114.6949892, 30.67463444),\n",
       " (-114.70925249999999, 30.86575361),\n",
       " (-115.69516499999999, 31.34003194),\n",
       " (-114.4629814, 29.90935278),\n",
       " (-116.6447186, 31.986784999999998),\n",
       " (-116.3605553, 31.25068528),\n",
       " (-114.69662140000001, 30.68467139),\n",
       " (-115.6567525, 31.57019389),\n",
       " (-116.45085719999999, 31.78367528),\n",
       " (-116.6004028, 32.09753861),\n",
       " (-114.69792079999999, 30.65641861),\n",
       " (-116.4601, 31.62584611),\n",
       " (-116.49757279999999, 31.84363389),\n",
       " (-115.7065169, 31.49387083),\n",
       " (-114.69781609999998, 30.62790167),\n",
       " (-116.2755906, 31.10469667),\n",
       " (-116.6842314, 31.96263194),\n",
       " (-116.66852140000002, 31.714685),\n",
       " (-116.1792639, 31.14573222),\n",
       " (-114.7072142, 30.71514167),\n",
       " (-116.30625330000001, 31.10300722),\n",
       " (-114.69836310000001, 30.68794694),\n",
       " (-114.6868586, 30.60658806),\n",
       " (-116.3579781, 31.87949972),\n",
       " (-115.9537078, 31.71046417),\n",
       " (-115.86866470000001, 31.45041833),\n",
       " (-116.4324222, 31.32188944),\n",
       " (-115.7308081, 31.44233528),\n",
       " (-114.6849756, 30.60194917),\n",
       " (-116.48083329999999, 31.86555556),\n",
       " (-116.35907890000001, 31.924540000000004),\n",
       " (-116.5565164, 31.46612722),\n",
       " (-116.51514440000001, 31.68164778),\n",
       " (-114.6392111, 30.50878222),\n",
       " (-116.51373219999999, 31.68545694),\n",
       " (-116.06138999999999, 31.095897499999996),\n",
       " (-116.10354440000002, 31.77315833),\n",
       " (-116.5818453, 31.79689611),\n",
       " (-115.79820919999999, 31.65212861),\n",
       " (-116.6082492, 31.92474333),\n",
       " (-114.6989544, 30.64263833),\n",
       " (-114.6997447, 30.6393875),\n",
       " (-114.63527250000001, 30.41259361),\n",
       " (-114.6410842, 30.36853694),\n",
       " (-114.69861110000001, 30.73361111),\n",
       " (-114.69680859999998, 30.68150889),\n",
       " (-116.49236609999998, 31.90481111),\n",
       " (-116.09999309999999, 31.71637917),\n",
       " (-116.2813567, 31.89590167),\n",
       " (-116.2051906, 31.9118625),\n",
       " (-116.68092859999999, 31.55305194),\n",
       " (-114.6697758, 30.5810925),\n",
       " (-116.4864736, 31.3830375),\n",
       " (-116.2705344, 31.89344722),\n",
       " (-116.5671919, 31.7617625),\n",
       " (-116.60408970000002, 31.72781833),\n",
       " (-116.787305, 32.07943139),\n",
       " (-115.826575, 31.73987639),\n",
       " (-116.5621886, 31.51349778),\n",
       " (-116.3856439, 31.4454),\n",
       " (-116.54631859999999, 31.67867806),\n",
       " (-116.65325690000002, 31.643395),\n",
       " (-115.7822939, 31.67120639),\n",
       " (-116.5394439, 31.93580861),\n",
       " (-116.5059114, 31.85000333),\n",
       " (-116.36427720000002, 31.55556694),\n",
       " (-116.47439920000001, 31.91273),\n",
       " (-116.31548059999999, 31.30870333),\n",
       " (-116.52413059999999, 31.67633556),\n",
       " (-116.79578219999999, 31.98486222),\n",
       " (-116.2606394, 31.48906722),\n",
       " (-115.79287079999999, 31.68269139),\n",
       " (-116.0481158, 31.83072583),\n",
       " (-116.6078147, 31.90616583),\n",
       " (-115.9533692, 31.76624611),\n",
       " (-116.6093758, 31.97920806),\n",
       " (-116.52611110000001, 31.86388889),\n",
       " (-114.6974453, 30.661167499999998),\n",
       " (-116.72439080000001, 31.90679194),\n",
       " (-116.49676140000001, 31.634645000000003),\n",
       " (-115.96255719999999, 31.508472499999996),\n",
       " (-114.70458640000001, 30.70110694),\n",
       " (-116.69214440000002, 31.911427500000002),\n",
       " (-116.1326267, 31.69739444),\n",
       " (-116.3918, 31.89140028),\n",
       " (-116.6372628, 31.99990833),\n",
       " (-116.7449994, 32.02582167),\n",
       " (-116.7684889, 32.01587972),\n",
       " (-116.64983559999999, 31.58288194),\n",
       " (-116.47199280000001, 31.89579472),\n",
       " (-116.66483059999999, 32.04768111),\n",
       " (-116.32525420000002, 31.48314806),\n",
       " (-116.47273670000001, 31.92790972),\n",
       " (-116.6643033, 31.92517417),\n",
       " (-116.1891606, 31.69484472),\n",
       " (-116.3162531, 31.07528556),\n",
       " (-114.7005867, 30.69518306),\n",
       " (-114.6963311, 30.66284333),\n",
       " (-116.66945420000002, 31.71774639),\n",
       " (-116.3055614, 31.51690667),\n",
       " (-116.4886814, 31.90624778),\n",
       " (-116.45269609999998, 31.89339944),\n",
       " (-116.47309720000001, 31.91878389),\n",
       " (-116.4598742, 31.896634999999996),\n",
       " (-116.40125640000001, 31.5142625),\n",
       " (-116.56932890000002, 31.791755),\n",
       " (-116.5607169, 31.79263944),\n",
       " (-116.64442360000001, 31.53970389),\n",
       " (-116.56714, 31.79013472),\n",
       " (-116.2943678, 31.96825139),\n",
       " (-115.9447222, 31.94861111),\n",
       " (-115.94194440000001, 31.96833333),\n",
       " (-115.9987778, 31.88327472),\n",
       " (-115.8977256, 31.88411667),\n",
       " (-115.8726611, 31.98094056),\n",
       " (-116.05700829999999, 31.83449722),\n",
       " (-116.2243033, 31.91615444),\n",
       " (-116.2363633, 31.9113),\n",
       " (-116.24472639999999, 31.91335611),\n",
       " (-116.2548644, 31.92485639),\n",
       " (-116.25804860000001, 31.93729722),\n",
       " (-116.2679064, 31.93446278),\n",
       " (-116.3096919, 31.98096222),\n",
       " (-116.3111831, 31.98639194),\n",
       " (-116.2974647, 31.9776875),\n",
       " (-116.2978636, 31.94672833),\n",
       " (-116.2434794, 31.91851083),\n",
       " (-116.2973053, 31.95725167),\n",
       " (-116.23321999999999, 31.92142528),\n",
       " (-116.28787309999998, 31.89758389),\n",
       " (-116.31516440000001, 31.95115639),\n",
       " (-116.2509808, 31.926122499999998),\n",
       " (-116.32905249999999, 31.94941722),\n",
       " (-116.3227575, 31.96435333),\n",
       " (-116.3376706, 31.97177278),\n",
       " (-116.33272, 31.97187611),\n",
       " (-116.3286111, 31.95),\n",
       " (-116.3160639, 31.95672806),\n",
       " (-116.5083619, 31.77123472),\n",
       " (-116.4633564, 31.78541917),\n",
       " (-116.8417139, 32.09883944),\n",
       " (-116.84787109999999, 32.10209222),\n",
       " (-116.81481140000001, 32.10309583),\n",
       " (-116.8228725, 32.09986778),\n",
       " (-116.79424640000002, 32.08180833),\n",
       " (-116.8836386, 32.08324778),\n",
       " (-116.88193940000001, 32.08553028),\n",
       " (-116.8783869, 32.06009083),\n",
       " (-116.87172939999999, 32.05903972),\n",
       " (-116.8837742, 32.04704833),\n",
       " (-116.8755669, 32.03625917),\n",
       " (-116.8726108, 32.05659861),\n",
       " (-116.56485579999999, 31.65864306),\n",
       " (-116.41464609999998, 31.74092972),\n",
       " (-116.5031231, 31.87967222),\n",
       " (-116.50363670000002, 31.87523639),\n",
       " (-116.4897547, 31.69685778),\n",
       " (-116.5140122, 31.67108833),\n",
       " (-116.5171967, 31.65579611),\n",
       " (-116.5452775, 31.67408028),\n",
       " (-116.56710690000001, 31.68255),\n",
       " (-116.6277183, 31.70048861),\n",
       " (-115.9484686, 31.623905),\n",
       " (-115.9370892, 31.62499444),\n",
       " (-115.9971317, 31.57663417),\n",
       " (-115.99093329999998, 31.56524028),\n",
       " (-115.9731108, 31.55210083),\n",
       " (-115.9806383, 31.56770556),\n",
       " (-115.81829280000001, 31.65940417),\n",
       " (-116.6547922, 31.72229417),\n",
       " (-116.62989669999999, 31.69508278),\n",
       " (-116.6715094, 31.7183225),\n",
       " (-116.3173372, 31.29677028),\n",
       " (-116.32131640000001, 31.30570667),\n",
       " (-116.25560359999999, 31.33624917),\n",
       " (-116.25412970000001, 31.336759999999998),\n",
       " (-116.25911440000002, 31.33485556),\n",
       " (-116.19019250000001, 31.33790222),\n",
       " (-116.1973336, 31.34141111),\n",
       " (-115.77143329999998, 31.39821056),\n",
       " (-115.7598622, 31.3624925),\n",
       " (-115.7506908, 31.36315056),\n",
       " (-115.74306029999998, 31.39581361),\n",
       " (-115.7399594, 31.38021972),\n",
       " (-115.740825, 31.39552889),\n",
       " (-115.74314640000001, 31.38620889),\n",
       " (-115.75033219999999, 31.37994806),\n",
       " (-115.7508542, 31.38801639),\n",
       " (-115.74287609999999, 31.38036472),\n",
       " (-115.7527217, 31.37757333),\n",
       " (-115.75764109999999, 31.38890028),\n",
       " (-115.77563059999999, 31.39362028),\n",
       " (-116.5201164, 31.88326139),\n",
       " (-115.58802469999999, 31.3442),\n",
       " (-115.58451140000001, 31.34115417),\n",
       " (-116.03478059999999, 31.33129722),\n",
       " (-116.5619028, 31.77703333),\n",
       " (-116.22234750000001, 31.22435667),\n",
       " (-116.1197608, 31.25318111),\n",
       " (-116.0836511, 31.09576694),\n",
       " (-116.56466499999999, 31.76536139),\n",
       " (-116.46479140000001, 31.78916944),\n",
       " (-116.49833329999998, 32.11361111),\n",
       " (-116.62572420000001, 32.08382111),\n",
       " (-116.6528567, 32.05623472),\n",
       " (-116.5974828, 32.1012525),\n",
       " (-116.5953, 32.0913525),\n",
       " (-116.63091609999998, 32.08661306),\n",
       " (-116.64468889999999, 32.08561972),\n",
       " (-116.63315559999998, 32.08380306),\n",
       " (-116.64562, 32.08575306),\n",
       " (-116.64695220000002, 32.08451028),\n",
       " (-116.6477331, 32.07393472),\n",
       " (-116.65467920000002, 32.05400972),\n",
       " (-116.5091881, 32.11261694),\n",
       " (-116.5108081, 32.11221611),\n",
       " (-116.585, 32.09),\n",
       " (-116.59155109999999, 32.0612525),\n",
       " (-116.59038500000001, 32.06273056),\n",
       " (-116.5867861, 32.06851083),\n",
       " (-116.5805131, 32.07582028),\n",
       " (-116.53150190000001, 32.10220694),\n",
       " (-116.52550890000002, 32.10394056),\n",
       " (-116.6119625, 32.07934194),\n",
       " (-116.6744889, 32.01369278),\n",
       " (-116.6830831, 31.99961278),\n",
       " (-116.68493670000001, 31.99813639),\n",
       " (-116.67259720000001, 32.00382778),\n",
       " (-116.7346358, 31.93765222),\n",
       " (-116.73271000000001, 31.94878139),\n",
       " (-116.7354303, 31.96364972),\n",
       " (-116.67465390000001, 32.00164361),\n",
       " (-116.68947390000001, 32.01058944),\n",
       " (-116.7432353, 31.98499083),\n",
       " (-116.73816670000001, 31.90674167),\n",
       " (-116.6577483, 31.96440722),\n",
       " (-116.65587109999998, 31.96473111),\n",
       " (-116.64319640000002, 31.96944667),\n",
       " (-116.6428939, 31.97072861),\n",
       " (-116.62779440000001, 31.97136833),\n",
       " (-116.62815690000001, 31.97771389),\n",
       " (-116.6541331, 31.977742499999998),\n",
       " (-116.6520969, 31.97931667),\n",
       " (-116.64668999999999, 31.98075111),\n",
       " (-116.6462758, 31.98377722),\n",
       " (-116.64384890000001, 31.98477278),\n",
       " (-116.62454170000001, 32.02468694),\n",
       " (-116.6064892, 32.0301825),\n",
       " (-116.6619019, 31.97943333),\n",
       " (-116.66579579999998, 31.96969972),\n",
       " (-116.6748325, 31.96775083),\n",
       " (-116.6589719, 31.98942194),\n",
       " (-116.63411609999999, 32.01840417),\n",
       " (-116.66084920000002, 32.00560333),\n",
       " (-116.6629603, 31.98576139),\n",
       " (-116.6432733, 32.01296528),\n",
       " (-116.6422064, 32.04784667),\n",
       " (-116.66967920000002, 32.01342389),\n",
       " (-116.65967749999999, 32.01222667),\n",
       " (-116.6723767, 32.01520861),\n",
       " (-116.6673672, 32.02441361),\n",
       " (-116.6316581, 32.03715222),\n",
       " (-116.6478822, 31.97712417),\n",
       " (-116.66367890000001, 32.022255),\n",
       " (-115.1947406, 28.35438333),\n",
       " (-115.3504981, 28.11625667),\n",
       " (-116.67656559999999, 31.92357472),\n",
       " (-116.6646011, 31.956372499999997),\n",
       " (-116.67535359999998, 31.92433056),\n",
       " (-116.67108359999999, 31.94346639),\n",
       " (-116.53690719999999, 31.67932833),\n",
       " (-116.5886244, 31.90614667),\n",
       " (-116.1642997, 30.96064528),\n",
       " (-116.26004920000001, 31.956275),\n",
       " (-116.38772720000001, 31.91034167),\n",
       " (-116.87128190000001, 32.0197125),\n",
       " (-116.8661489, 32.04494722),\n",
       " (-116.7538317, 32.00545278),\n",
       " (-116.64614309999999, 32.03082111),\n",
       " (-115.7663889, 31.64861111),\n",
       " (-116.5360347, 31.88754778),\n",
       " (-116.5533631, 31.87010889),\n",
       " (-115.94666670000001, 31.70611111),\n",
       " (-116.5203153, 31.88445917),\n",
       " (-116.5957242, 32.05094361),\n",
       " (-116.75449029999999, 31.92831944),\n",
       " (-116.64981470000001, 31.98183972),\n",
       " (-116.18374250000001, 31.289184999999996),\n",
       " (-115.6902372, 31.35943528),\n",
       " (-115.7282878, 31.38361194),\n",
       " (-115.6909983, 31.36087611),\n",
       " (-115.7369067, 31.35448028),\n",
       " (-115.7231581, 31.34227444),\n",
       " (-115.73952560000001, 31.340740000000004),\n",
       " (-115.672655, 31.37488556),\n",
       " (-115.6420475, 31.36324861),\n",
       " (-116.021375, 31.97311194),\n",
       " (-116.2954831, 31.90715167),\n",
       " (-116.6364889, 31.99666417),\n",
       " (-116.3053494, 31.98208556),\n",
       " (-116.3102631, 31.991840000000003),\n",
       " (-116.4062256, 31.70590833),\n",
       " (-116.54480079999999, 31.70734472),\n",
       " (-116.57719420000001, 31.81065528),\n",
       " (-115.74666189999999, 31.38275167),\n",
       " (-116.2404078, 30.93455194),\n",
       " (-116.5042153, 31.90754694),\n",
       " (-116.4513692, 31.89783472),\n",
       " (-116.2486514, 31.92482028),\n",
       " (-116.20381110000001, 31.8354325),\n",
       " (-116.3080808, 31.94650028),\n",
       " (-116.2611233, 31.93647778),\n",
       " (-116.2577392, 31.90830611),\n",
       " (-116.59992609999999, 32.062215),\n",
       " (-116.5345942, 31.76416167),\n",
       " (-116.33607109999998, 31.98026389),\n",
       " (-115.74261329999999, 31.37344028),\n",
       " (-115.72492609999999, 31.39653222),\n",
       " (-115.7207003, 31.39606694),\n",
       " (-116.32669440000001, 31.38689111),\n",
       " (-115.9750975, 31.51757861),\n",
       " (-116.44992309999999, 31.34435333),\n",
       " (-116.44392830000001, 31.79159417),\n",
       " (-116.0834739, 31.09273861),\n",
       " (-116.20153859999999, 31.08776194),\n",
       " (-116.2170761, 31.04441889),\n",
       " (-116.1979311, 30.99184639),\n",
       " (-116.14535390000002, 30.97484083),\n",
       " (-116.2680639, 31.41915444),\n",
       " (-116.5228817, 31.44670611),\n",
       " (-116.5063892, 31.78633917),\n",
       " (-116.6377778, 31.91972222),\n",
       " (-116.6707136, 31.93677167),\n",
       " (-116.67137859999998, 31.93545556),\n",
       " (-116.69420079999999, 31.9118125),\n",
       " (-116.5213747, 31.88334694),\n",
       " (-116.54051809999999, 31.900127500000004),\n",
       " (-116.59371670000002, 31.91530972),\n",
       " (-116.7117831, 31.73717056),\n",
       " (-116.69622220000001, 31.72983222),\n",
       " (-116.67845940000001, 31.72472944),\n",
       " (-116.6842378, 31.72527111),\n",
       " (-116.6941906, 31.72109472),\n",
       " (-116.6741122, 31.70181722),\n",
       " (-116.62963359999999, 32.12559639),\n",
       " (-115.98651000000001, 31.91656639),\n",
       " (-116.52231359999999, 31.86736806),\n",
       " (-116.63685859999998, 31.742275),\n",
       " (-115.9274058, 32.104115),\n",
       " (-116.59728670000001, 31.72367611),\n",
       " (-116.6612989, 31.97527778),\n",
       " (-116.51100079999999, 31.88098139),\n",
       " (-116.5144967, 31.88597),\n",
       " (-114.6932953, 30.618554999999997),\n",
       " (-116.6581158, 31.63187694),\n",
       " (-114.6377497, 30.40019222),\n",
       " (-114.698375, 30.645),\n",
       " (-114.3926861, 29.78231694),\n",
       " (-114.7004442, 30.73030556),\n",
       " (-114.3045914, 29.73628778),\n",
       " (-114.64181470000001, 30.34105556),\n",
       " (-116.2237922, 31.06931583),\n",
       " (-116.72229499999999, 31.72947056),\n",
       " (-116.2265742, 31.91333778),\n",
       " (-114.70676440000001, 30.71221194),\n",
       " (-114.4817167, 29.93842528),\n",
       " (-114.6974528, 30.73719333),\n",
       " (-114.67647579999999, 30.58664139),\n",
       " (-114.6843128, 30.59839556),\n",
       " (-114.69513470000001, 30.67255444),\n",
       " (-116.62523030000001, 31.76174556),\n",
       " (-116.87508829999999, 32.090325),\n",
       " (-114.66060359999999, 30.56383833),\n",
       " (-116.63905530000001, 31.54368306),\n",
       " (-116.5444719, 31.75738417),\n",
       " (-116.56195109999999, 31.784047499999996),\n",
       " (-115.8197969, 31.72820306),\n",
       " (-116.1943828, 31.47955222),\n",
       " (-114.2911756, 29.51700278),\n",
       " (-116.575, 32.08138889),\n",
       " (-116.441125, 31.90218583),\n",
       " (-116.5940219, 32.05936),\n",
       " (-116.59090309999999, 32.06291417),\n",
       " (-116.42178670000001, 31.58338361),\n",
       " (-116.42596499999999, 31.56012083),\n",
       " (-116.25857420000001, 31.42118583),\n",
       " (-116.7173378, 32.027565),\n",
       " (-115.7249628, 31.39349972),\n",
       " (-116.07740190000001, 31.85356556),\n",
       " (-116.6791706, 31.99468417),\n",
       " (-116.63524140000001, 31.96252722),\n",
       " (-116.32082859999998, 31.30265778),\n",
       " (-116.6312425, 31.54452111),\n",
       " (-116.2662394, 31.33088778),\n",
       " (-116.671195, 32.03353667),\n",
       " (-116.1436094, 31.12239472),\n",
       " (-116.64087190000001, 31.98898222),\n",
       " (-116.59247920000001, 31.76212778),\n",
       " (-116.62846280000001, 31.9766075),\n",
       " (-116.32700220000001, 31.34370611),\n",
       " (-116.6424114, 32.04826361),\n",
       " (-116.4297664, 31.62817222),\n",
       " (-116.6523639, 32.01104),\n",
       " (-116.6130139, 32.02548278),\n",
       " (-116.64779579999998, 32.01856444),\n",
       " (-116.6295442, 32.09248194),\n",
       " (-116.6447642, 32.08984333),\n",
       " (-116.6380494, 32.04000917),\n",
       " (-116.67340559999998, 32.02817222),\n",
       " (-116.6503278, 32.05424806),\n",
       " (-116.66865559999998, 31.70411139),\n",
       " (-116.68222220000001, 32.00638889),\n",
       " (-116.6474636, 32.04453083),\n",
       " (-116.4647503, 31.62797139),\n",
       " (-116.46172920000001, 31.62241972),\n",
       " (-116.64153359999999, 32.05031444),\n",
       " (-116.6084633, 32.06666),\n",
       " (-116.6541272, 32.03211722),\n",
       " (-116.5860794, 32.08952194),\n",
       " (-116.64944440000001, 32.05444444),\n",
       " (-116.6468436, 31.97537972),\n",
       " (-116.6522947, 32.05793056),\n",
       " (-116.6399836, 32.06587889),\n",
       " (-116.6580294, 32.01693972),\n",
       " (-115.93028000000001, 31.62867667),\n",
       " (-116.56455249999999, 32.09013278),\n",
       " (-116.4193203, 31.62864111),\n",
       " (-116.40593, 31.62901472),\n",
       " (-116.45161940000001, 31.61707361),\n",
       " (-116.643495, 32.04668028),\n",
       " (-116.6569539, 32.03895444),\n",
       " (-116.65194029999999, 32.05917389),\n",
       " (-116.4576186, 31.56605583),\n",
       " (-116.6431025, 32.07020639),\n",
       " (-116.6162006, 32.07764778),\n",
       " (-116.64200890000002, 31.98492417),\n",
       " (-114.69875420000001, 30.62435639),\n",
       " (-116.65311080000001, 32.07191833),\n",
       " (-116.6492769, 32.06162611),\n",
       " (-116.13939779999998, 31.12302139),\n",
       " (-116.63769690000001, 32.11243556),\n",
       " (-116.63525220000001, 32.104595),\n",
       " (-116.2216172, 31.93285972),\n",
       " (-116.63114170000001, 31.989617499999998),\n",
       " (-116.10187250000001, 31.10316361),\n",
       " (-116.1109364, 31.09692),\n",
       " (-116.4977003, 31.91052583),\n",
       " (-116.4958886, 31.88900056),\n",
       " (-116.59229140000001, 31.69240417),\n",
       " (-116.1663889, 31.34444444),\n",
       " (-116.13689860000001, 31.1193),\n",
       " (-116.4210597, 31.73332056),\n",
       " (-116.83465190000001, 32.02996111),\n",
       " (-116.6538436, 31.53026306),\n",
       " (-114.6407375, 30.43911389),\n",
       " (-116.67449579999999, 31.98556472),\n",
       " (-116.3575125, 31.23834167),\n",
       " (-116.2955058, 31.93667806),\n",
       " (-116.6495217, 32.04735167),\n",
       " (-116.4664614, 31.71239778),\n",
       " (-116.2585247, 31.32962944),\n",
       " (-116.6977164, 31.94041167),\n",
       " (-116.6768564, 31.98737222),\n",
       " (-116.4055347, 31.92267083),\n",
       " (-116.4326031, 31.58181528),\n",
       " (-116.6194581, 32.06247417),\n",
       " (-116.4539453, 31.57664194),\n",
       " (-116.21218529999999, 31.05176278),\n",
       " (-116.6410472, 32.05131611),\n",
       " (-116.4640483, 31.57330944),\n",
       " (-116.43886280000001, 31.56225778),\n",
       " (-116.4342231, 31.56499667),\n",
       " (-116.42193329999999, 31.56424722),\n",
       " (-116.5612831, 31.75776361),\n",
       " (-116.62255079999998, 32.10118278),\n",
       " (-116.6086422, 32.09991889),\n",
       " (-116.6021753, 31.77177306),\n",
       " (-116.5939156, 31.77238056),\n",
       " (-116.5977206, 31.76748639),\n",
       " (-116.59330420000002, 31.76852194),\n",
       " (-116.58904609999999, 31.76767111),\n",
       " (-116.5874533, 31.76815694),\n",
       " (-116.58401029999999, 31.77047167),\n",
       " (-116.58862109999998, 31.76302917),\n",
       " (-116.5868608, 31.76342556),\n",
       " (-116.58010890000001, 31.76428306),\n",
       " (-116.5749131, 31.76512944),\n",
       " (-116.5972222, 31.75027778),\n",
       " (-116.57881780000001, 31.76229389),\n",
       " (-116.57790940000001, 31.76167111),\n",
       " (-116.5712092, 31.76445861),\n",
       " (-116.56527779999999, 31.7625),\n",
       " (-116.59022890000001, 31.753617499999997),\n",
       " (-116.5870656, 31.75478111),\n",
       " (-116.5814372, 31.75493972),\n",
       " (-116.578065, 31.75632139),\n",
       " (-116.5731808, 31.75626972),\n",
       " (-116.5689658, 31.75673278),\n",
       " (-116.56422859999998, 31.75742667),\n",
       " (-116.5591347, 31.75879583),\n",
       " (-116.54492330000001, 31.76012167),\n",
       " (-116.5893775, 31.74925333),\n",
       " (-116.5813317, 31.75412139),\n",
       " (-116.57730829999998, 31.75473556),\n",
       " (-116.57290559999998, 31.75536861),\n",
       " (-116.56913329999999, 31.75579861),\n",
       " (-116.5649506, 31.75627667),\n",
       " (-116.55207220000001, 31.75696556),\n",
       " (-116.5967114, 31.74332361),\n",
       " (-116.5883172, 31.74508667),\n",
       " (-116.58602749999999, 31.74506389),\n",
       " (-116.5794392, 31.74571917),\n",
       " (-116.57604280000001, 31.74863167),\n",
       " (-116.57181940000001, 31.74945833),\n",
       " (-116.5606356, 31.74870194),\n",
       " (-116.55681940000001, 31.74852444),\n",
       " (-116.60395220000001, 31.73531139),\n",
       " (-116.5881614, 31.74304639),\n",
       " (-116.57455060000001, 31.74210639),\n",
       " (-116.5709311, 31.74537917),\n",
       " (-116.56951529999999, 31.74425333),\n",
       " (-116.5658172, 31.745145),\n",
       " (-116.5952203, 31.73569417),\n",
       " (-116.59191580000001, 31.73488861),\n",
       " (-116.59836170000001, 31.72914833),\n",
       " (-116.58976170000001, 31.73031083),\n",
       " (-116.61347279999998, 31.72219889),\n",
       " (-116.5977767, 31.72599306),\n",
       " (-116.58835719999999, 31.72595611),\n",
       " (-116.5860067, 31.72639333),\n",
       " (-116.61784750000001, 31.71895972),\n",
       " (-116.5858208, 31.72528056),\n",
       " (-116.62119809999999, 31.71250917),\n",
       " (-116.62527920000001, 31.711142499999998),\n",
       " (-116.60444440000002, 31.71444444),\n",
       " (-116.61837609999999, 31.71229472),\n",
       " (-116.5966344, 31.72140028),\n",
       " (-116.59149359999999, 31.71784111),\n",
       " (-116.5877778, 31.71694444),\n",
       " (-116.57782720000002, 31.7180875),\n",
       " (-116.58032079999998, 31.71791861),\n",
       " (-116.6207164, 31.71072444),\n",
       " (-116.6113739, 31.71170111),\n",
       " (-116.59950220000002, 31.71408972),\n",
       " (-116.5956133, 31.71462583),\n",
       " (-116.59061329999999, 31.71287194),\n",
       " (-116.58693079999999, 31.71456944),\n",
       " (-116.5813889, 31.71277778),\n",
       " (-116.61741, 31.70401028),\n",
       " (-116.6115564, 31.703752500000004),\n",
       " (-116.6097675, 31.70441056),\n",
       " (-116.6058511, 31.70462833),\n",
       " (-116.60102830000001, 31.70752278),\n",
       " (-116.58967220000001, 31.70733111),\n",
       " (-116.5848656, 31.70763389),\n",
       " (-116.5779453, 31.71293556),\n",
       " (-116.6207044, 31.70163667),\n",
       " (-116.61658390000001, 31.70195139),\n",
       " (-116.6031992, 31.70242306),\n",
       " (-116.59628059999999, 31.70491028),\n",
       " (-116.58443249999999, 31.7032375),\n",
       " (-116.58055559999998, 31.70472222),\n",
       " (-116.57483219999999, 31.70870417),\n",
       " (-116.62417250000001, 31.69338167),\n",
       " (-116.6206628, 31.69718444),\n",
       " (-116.60964720000001, 31.69867111),\n",
       " (-116.61379720000001, 31.694105),\n",
       " (-116.5879856, 31.69998639),\n",
       " (-116.57580109999999, 31.70072667),\n",
       " (-116.62028470000001, 31.68952722),\n",
       " (-116.6131644, 31.68805944),\n",
       " (-116.6079961, 31.69046722),\n",
       " (-116.61914250000001, 31.68543778),\n",
       " (-116.5675808, 31.69654139),\n",
       " (-116.55168970000001, 31.6936),\n",
       " (-116.5608336, 31.68961139),\n",
       " (-116.4696453, 31.90093806),\n",
       " (-116.32215890000002, 31.95836056),\n",
       " (-116.6327456, 32.01692722),\n",
       " (-116.06134890000001, 31.73426083),\n",
       " (-116.8111767, 32.10444222),\n",
       " (-116.44753610000001, 32.14125278),\n",
       " (-116.76337920000002, 32.01752889),\n",
       " (-114.71071, 30.68750083),\n",
       " (-116.58850670000001, 32.06420389),\n",
       " (-116.68803500000001, 31.70535694),\n",
       " (-116.26168559999999, 31.92302583),\n",
       " (-116.6173425, 31.89064611),\n",
       " (-116.2449253, 30.99428),\n",
       " (-116.6597972, 32.05153528),\n",
       " (-116.60136440000001, 32.06477778),\n",
       " (-116.4135358, 31.63683472),\n",
       " (-116.65549329999999, 31.97614),\n",
       " (-116.63082390000001, 32.01164667),\n",
       " (-116.6034794, 32.06572917),\n",
       " (-116.5037064, 31.688372499999996),\n",
       " (-115.8901092, 31.66830444),\n",
       " (-116.6672011, 31.98807917),\n",
       " (-116.61014250000001, 31.9080625),\n",
       " (-116.41346940000001, 31.63500361),\n",
       " (-116.63554309999999, 31.96177667),\n",
       " (-116.61193109999999, 31.55449361),\n",
       " (-115.9480889, 31.64509361),\n",
       " (-116.2925669, 31.96463583),\n",
       " (-116.59429420000001, 31.70922278),\n",
       " (-116.6038389, 31.54996417),\n",
       " (-115.73486670000001, 31.41734417),\n",
       " (-116.6153544, 31.72659139),\n",
       " (-115.96035390000002, 31.75827556),\n",
       " (-116.6509358, 31.53885667),\n",
       " (-116.47174170000001, 31.4182525),\n",
       " (-116.5575011, 32.0473875),\n",
       " (-116.0990742, 31.10004139),\n",
       " (-116.24292140000001, 31.24665694),\n",
       " (-116.6662397, 31.98756833),\n",
       " (-116.57814309999999, 31.66561667),\n",
       " (-116.4606486, 31.71172778),\n",
       " (-116.5867892, 31.80327667),\n",
       " (-116.29709140000001, 31.46743833),\n",
       " (-116.61084779999999, 32.00193639),\n",
       " (-115.8056617, 31.65043139),\n",
       " (-116.61544690000001, 32.09442861),\n",
       " (-115.63533079999999, 31.2774025),\n",
       " (-116.5705408, 31.68081861),\n",
       " (-116.1880467, 31.33688778),\n",
       " (-114.41372390000001, 29.79259944),\n",
       " (-116.47131809999999, 31.56946694),\n",
       " (-116.6587372, 31.96504333),\n",
       " (-116.4116317, 31.62787861),\n",
       " (-116.3643672, 31.53840722),\n",
       " (-116.2577764, 31.33213167),\n",
       " (-116.6418186, 31.97019861),\n",
       " (-116.43254109999998, 31.70775333),\n",
       " (-116.4789, 31.84959194),\n",
       " (-116.37295060000001, 31.408045),\n",
       " (-116.210175, 31.940122499999998),\n",
       " (-116.43058329999998, 31.42086611),\n",
       " (-116.13560559999999, 31.21212333),\n",
       " (-116.6065219, 32.06732139),\n",
       " (-116.20903500000001, 31.05302778),\n",
       " (-116.2197919, 31.33995417),\n",
       " (-116.4934956, 32.17933278),\n",
       " (-116.2469481, 31.93026417),\n",
       " (-116.66074640000002, 31.96350667),\n",
       " (-115.72122079999998, 31.3694125),\n",
       " (-116.39210190000001, 31.829359999999998),\n",
       " (-116.06531170000001, 31.10593278),\n",
       " (-116.6502778, 32.01888889),\n",
       " (-116.4219717, 31.56112944),\n",
       " (-116.6049972, 32.08194444),\n",
       " (-116.30400970000001, 31.957372499999998),\n",
       " (-116.2493422, 31.02301417),\n",
       " (-116.24223059999998, 31.02225556),\n",
       " (-116.5873139, 31.73539694),\n",
       " (-116.67479499999999, 32.01047639),\n",
       " (-116.6300686, 32.03892972),\n",
       " (-116.595235, 32.05659944),\n",
       " (-116.23647609999999, 31.88203778),\n",
       " (-116.65325940000001, 32.05479861),\n",
       " (-115.65244969999999, 31.57211972),\n",
       " (-116.6207303, 31.97848389),\n",
       " (-116.6741533, 32.02868556),\n",
       " (-116.54025390000001, 31.76007444),\n",
       " (-116.65426780000001, 32.03947583),\n",
       " (-116.417395, 31.56407944),\n",
       " (-116.59255970000001, 31.76598806),\n",
       " (-116.32894109999998, 31.97867028),\n",
       " (-116.6231053, 31.72336361),\n",
       " (-116.5265314, 31.67376111),\n",
       " (-116.5376811, 32.0994825),\n",
       " (-116.64286329999999, 32.04305639),\n",
       " (-116.64154609999999, 32.00884056),\n",
       " (-116.53622720000001, 32.10068611),\n",
       " (-116.6163186, 32.01737611),\n",
       " (-116.4476753, 31.901529999999998),\n",
       " (-116.66028109999999, 32.04251472),\n",
       " (-115.99016809999999, 31.57013667),\n",
       " (-116.24661189999999, 31.20458444),\n",
       " (-116.6668769, 31.951590000000003),\n",
       " (-116.64439499999999, 31.96993861),\n",
       " (-116.6131467, 31.89340833),\n",
       " (-116.56602920000002, 31.90461306),\n",
       " (-116.62620919999999, 32.01926444),\n",
       " (-116.62451940000001, 32.02758528),\n",
       " (-116.63043689999999, 32.02176306),\n",
       " (-116.78021329999999, 32.02508694),\n",
       " (-116.6649139, 31.98809889),\n",
       " (-116.8322706, 32.10005611),\n",
       " (-116.59386059999999, 32.05829972),\n",
       " (-116.73761809999999, 31.97802528),\n",
       " (-116.78121000000002, 32.0294825),\n",
       " (-116.61223059999999, 32.02577639),\n",
       " (-116.61011609999998, 32.02524556),\n",
       " (-116.6594742, 32.00855722),\n",
       " (-116.65236170000001, 32.03339778),\n",
       " (-116.6353314, 31.99746028),\n",
       " (-116.6161206, 31.71099083),\n",
       " (-116.6051947, 31.730790000000002),\n",
       " (-116.61489440000001, 31.71070444),\n",
       " (-116.5800992, 31.70689917),\n",
       " (-116.58732420000001, 31.74944722),\n",
       " (-116.59756170000001, 31.76265972),\n",
       " (-116.59616580000001, 31.74056389),\n",
       " (-116.5833572, 31.69997583),\n",
       " (-116.5351967, 31.68140722),\n",
       " (-116.6561189, 31.71558111),\n",
       " (-116.61537390000001, 32.02640556),\n",
       " (-115.93838640000001, 31.53834389),\n",
       " (-115.7256003, 31.37471528),\n",
       " (-115.6146072, 31.35445111),\n",
       " (-115.61430530000001, 31.35098944),\n",
       " (-115.6974978, 31.355234999999997),\n",
       " (-116.20155109999999, 31.28286083),\n",
       " (-116.16436940000001, 31.22014278),\n",
       " (-116.1798361, 31.25053583),\n",
       " (-116.1705125, 31.21401194),\n",
       " (-116.10642250000001, 31.25329917),\n",
       " (-116.1484017, 30.969972499999997),\n",
       " (-116.21603359999999, 31.300340000000002),\n",
       " (-116.6790528, 31.98510722),\n",
       " (-116.5745733, 31.61843194),\n",
       " (-116.70808000000001, 31.91018444),\n",
       " (-116.23485890000002, 31.90747028),\n",
       " (-114.475, 29.91944444),\n",
       " (-114.69567579999999, 30.62192583),\n",
       " (-116.71088940000001, 31.71698278),\n",
       " (-116.1979689, 31.08437806),\n",
       " (-116.4394264, 31.57972944),\n",
       " (-116.43222220000001, 31.57226444),\n",
       " (-115.78874499999999, 31.22830417),\n",
       " (-116.25751499999998, 30.99601556),\n",
       " (-116.42852579999999, 31.575897499999996),\n",
       " (-116.433555, 31.56938417),\n",
       " (-114.7049006, 30.82657917),\n",
       " (-116.25131329999999, 31.33321889),\n",
       " ...]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Creación de coordenadas por localidad\n",
    "pob_coords = [(x,y) for x,y in zip(geopob['geometry'].x , geopob['geometry'].y)]\n",
    "pob_coords"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "5285c1ec31ad4580ab9bda2755429dae",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Map(center=[32.5027, -117.00371], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', …"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Visualización de relación centros de salud versus densidad poblacional\n",
    "from ipyleaflet import Map, Heatmap, FullScreenControl, GeoJSON\n",
    "m = Map(center=[32.5027, -117.00371], zoom=8, dragging= True)\n",
    "m.add_control(FullScreenControl())\n",
    "\n",
    "result = voronoi(points)\n",
    "\n",
    "#heatmap\n",
    "heatmap = Heatmap(\n",
    "    locations=[[point[1], point[0]] for point in pob_coords],\n",
    "    radius=20, min_opacity=0.50, max=1,\n",
    ")\n",
    "\n",
    "\n",
    "#voronoi\n",
    "for point in points:\n",
    "    marker = Marker(location=[point[1], point[0]], visible=False) #Cambiar el atributo \"visible\" a \"True\" para ver los puntos de los centros de salud\n",
    "    m.add_layer(marker)\n",
    "\n",
    "vor = GeoJSON(name=\"Original\", data=result, style={\"color\": \"green\"})\n",
    "\n",
    "\n",
    "#map layers\n",
    "m.add_layer(vor)\n",
    "m.add_layer(heatmap);\n",
    "\n",
    "m"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En el mapa que contiene la capa del diagrama de Voronoi por ubicación de hospitales cruzada con la de densidad poblacional por localidad, podemos identificar cuáles son aquellas áreas en donde es necesario hacer un análisis más profundo sobre las necesidades de servicios de salud.\n",
    "\n",
    "Un ejemplo de puntos con alta densidad poblacional pero poca oferta de salud a los que habría que poner atención son El Hongo, Punta Colonet, Ojos Negros, Ejido Tula, por mencional algunos. Sin embargo, si vamos al código y activamos la visualización de la localización de los centros de salud, podemos observar que quizás Ojos Negros está en el punto correcto de atención. Este análisis se puede mejorar al tener la granularidad de densidad de población por manzana.\n",
    "\n",
    "\n",
    "Esta visualización no sólo nos ayuda a ver la necesidad de centros de salud por población, sino que también se podrían cargar bases de datos con padecimientos y aquellos centros o consultorios que atienden cierta especialidad. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Análisis de trayectorias de pacientes a centros de salud"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Otro análisis importante para tener más información sobre cómo y a quiénes se brindan los servicios de salud es el de observar las trayectorias y distancias de los pacientes a los centros de salud.\n",
    "\n",
    "En este paso se usaron datos de muestra (dummies) sobre los códigos postales de los pacientes para realizar la prueba de concepto. De tener estos datos por hospital, podríamos ver de dónde provienen los pacientes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "import ipywidgets as widgets\n",
    "from IPython.display import display\n",
    "import pgeocode\n",
    "from geopy.distance import geodesic\n",
    "from turfpy import measurement\n",
    "from geojson import Point, Feature\n",
    "\n",
    "#Configuración previa para dropdown\n",
    "ALL= 'BCCIJ000014' \n",
    "def unique_sorted_values_plus_ALL(array):  \n",
    "    unique = array.unique().tolist()  \n",
    "    unique.sort()  \n",
    "    unique.insert(0, ALL)  \n",
    "    return unique"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "926f65702e3640f3bd1ec3d52f98f95b",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Dropdown(options=('BCCIJ000014', 'BCCIJ000014', 'BCCIJ000026', 'BCCRO000014', 'BCCRO000026', 'BCCRO000031', 'B…"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Configuración de dropdown con clues\n",
    "dropdown_clues = widgets.Dropdown(options = unique_sorted_values_plus_ALL(clues.title))\n",
    "output_clues = widgets.Output()\n",
    "\n",
    "def dropdown_clues_eventhandler(change):  \n",
    "    output_clues.clear_output()  \n",
    "    with output_clues:  \n",
    "        if (change.new == ALL):  \n",
    "            display(clues)  \n",
    "        else:  \n",
    "            display(clues[clues.title == change.new])\n",
    "        \n",
    "dropdown_clues.observe(dropdown_clues_eventhandler, names='value')\n",
    "\n",
    "display(dropdown_clues)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "⬆️ Se debe seleccionar un centro de salud (clave CLUES) del dropdown antes de correr las celdas siguientes (por default aparece BCCRO000041)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "da30a32e55094182b0b32ba410690dda",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Output()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(output_clues)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "⬆️ Centro de salud seleccionado"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "#A partir de este punto se deben correr las celdas manualmente cada vez que se realice un cambio en el Centro de Salud seleccionado.\n",
    "\n",
    "#Obtención de variables a partir del punto seleccionado en caso de ser necesarias para otro tipo de análisis\n",
    "selected_clues=dropdown_clues.value\n",
    "selectedLat=clues[clues.title == selected_clues].latitude\n",
    "selectedLon=clues[clues.title == selected_clues].longitude\n",
    "selectedGeometry=clues[clues.title == selected_clues].geometry"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Obtención de muestra de códigos postales para realizar prueba de concepto.\n",
    "nomi = pgeocode.Nominatim('mx')\n",
    "nomi._data_frame\n",
    "df = nomi._data_frame\n",
    "df = df[df['state_name']=='Baja California']\n",
    "dfSample = df.sample(n=20,axis='rows')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Cálculo de distancias del código postal de residencia de los pacientes al centro de salud seleccionado\n",
    "from geopy.distance import geodesic\n",
    "from turfpy import measurement\n",
    "from geojson import Point, Feature\n",
    "\n",
    "coords_hospital = float(selectedLat), float(selectedLon)\n",
    "def distance_from_hospital(row):\n",
    "    comparison = (float(row['latitude']),float(row['longitude']))\n",
    "    val = geodesic(coords_hospital, comparison).km\n",
    "    return val\n",
    "dfSample['distancia'] = dfSample.apply(distance_from_hospital, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "dfSample['distancia'].hist()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Este histograma muestra los grupos de distancias de los pacientes que acuden al hospital seleccionado."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [],
   "source": [
    "geoHospitalPuntos = gpd.GeoDataFrame(\n",
    "    dfSample, geometry=gpd.points_from_xy(dfSample.longitude, dfSample.latitude))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "970a0a72b7d948e7ac906892e1ceafae",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Map(center=[32.5027, -117.00371], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title', …"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Mapa de centro de salud seleccionado y las ubicaciones de las residencias de los pacientes.\n",
    "from ipyleaflet import Map, Heatmap, FullScreenControl, GeoJSON, CircleMarker\n",
    "from ipyleaflet import Marker, Icon, Map\n",
    "m = Map(center=[32.5027, -117.00371], zoom=4, dragging= True)\n",
    "m.add_control(FullScreenControl())\n",
    "\n",
    "points = [(x,y) for x,y in zip(geoHospitalPuntos['geometry'].x , geoHospitalPuntos['geometry'].y)]\n",
    "\n",
    "\n",
    "\n",
    "m = Map(center=[32.5027, -117.00371], zoom=7)\n",
    "\n",
    "for point in points:\n",
    "    marker = Marker(location=[point[1], point[0]])\n",
    "    m.add_layer(marker)\n",
    "\n",
    "icon = Icon(icon_url='https://www.freeiconspng.com/uploads/hospital-building-icon-6.png', icon_size=[38, 38], icon_anchor=[19,19])\n",
    "mark = Marker(location=coords_hospital, icon=icon, rotation_angle=0, rotation_origin='22px 94px')\n",
    "m.add_layer(mark);\n",
    "m"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "En este ejemplo efectuado con datos dummy podemos tener una idea del tipo de información que podríamos obtener con este análisis. El ícono del hospital es aquel del centro de salud seleccionado, mientras que los demás puntos (en azul) muestran los códigos postales de los pacientes que llegan a ese centro de salud. \n",
    "\n",
    "Como se mencionó en el análisis de densidad poblacional, este mapeo puede ser de gran utilidad cuando se realiza un filtro por padecimiento para saber en dónde se requiere añadir esa especialidad. Si habría centros de salud que atienden ese padecimiento, pero aún así existe un traslado significante de pacientes a este centro, podríamos indagar sobre la calidad del servicio percibida, o la capacidad de los centros de atención más cercanos."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Conclusión\n",
    "Las cuatro visualizaciones mostradas (Voronoi de centros de salud, Voronoi y Densidad poblacional, histograma de distancias de pacientes, y mapa de pacientes a centro de salud seleccionado) nos pueden ayudar a contestar las siguientes preguntas: ¿Existen suficientes centros de salud para atender a toda la población de X lugar? ¿Cuánto viaja la mayoría de mis pacientes? ¿Existe suficiente oferta por especialidad?\n",
    "\n",
    "\n",
    "Con más bases de datos acerca de padecimientos, e incluso indicadores socioeconómicos, podremos crear una superposición que nos ayude a identificar un acercamiento a las respuestas necesarias para tomar mejores decisiones en políticas públicas e inversión en salud."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Propuesta de seguimiento\n",
    "Pasos para análisis posterior:\n",
    "    - Limpiar la fuente de datos actuales o utilizar base de datos de centro de salud públicos o similar para hacer diagrama de Voronoi. También podrá utilizarse el código para hacer un análisis de la ubicación de hospitales especializados en Covid y datos de casos por centro urbano. \n",
    "    - Utilizar datos de la residencia de pacientes con sus códigos postales para poder hacer analizar la distancia recorrida por ellos hacia los hospitales"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Referencias\n",
    "\n",
    "G.M. Venkatesh , Siddharthan. S Metri (2011). Distance as a Determinant of Health Services Utilization by the Community Based Health Insured People http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.302.1995&rep=rep1&type=pdf\n",
    "\n",
    "Barraza-Lloréns, M., Bertozzi, S., González-Pier, E., & Gutiérrez, J. P. (2002). Addressing Inequity In Health And Health Care In Mexico. Health Affairs, 21(3), 47–56. doi:10.1377/hlthaff.21.3.47 \n",
    "url to share this paper:\n",
    "sci-hub.se/10.1377/hlthaff.21.3.47\n",
    "\n",
    "\n",
    "\n",
    "Bravo Trinidad, s.f., Diagrama de Voronoi, presentación de clase.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "## Autores\n",
    "\n",
    "\n",
    "Marcela Cruz Félix (https://www.linkedin.com/in/marscrfx/)\n",
    "\n",
    "David Rolando Cornejo Arias (https://www.linkedin.com/in/david-cornejo-613b3165/)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
